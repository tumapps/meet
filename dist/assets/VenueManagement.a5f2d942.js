import{_ as fe,k as ye,j as p,A as ge,z as _e,y as be,q as ke,r as x,o as d,c as m,d as l,w as n,b as t,e as P,m as B,D as we,F as O,C as K,G as z,v as L,t as y,n as k,l as E,g as ee,p as Ce}from"./index.e0205fad.js";import{C as q}from"./component.da87e159.js";import"./pdfjs.7adb8c57.js";import"./index.f7b24e3d.js";const Pe={class:"d-flex justify-content-end"},xe={class:"d-flex justify-content-between"},$e={class:"d-flex align-items-center"},he=["value"],Ae={class:"d-flex align-items-center",style:{"max-width":"180px"}},Ve={class:"table-responsive"},Se={class:"table table-hover"},Te=["onClick"],Be=["onClick"],Ue=["onClick"],De=["onClick"],Me={key:1},Ne={"aria-label":"Page navigation"},He={class:"pagination justify-content-end"},je=["disabled"],Ie=["onClick"],Fe=["disabled"],Oe={class:"mb-3"},ze={key:0,class:"error","aria-live":"polite"},Le={class:"mb-3"},Ee={key:0,class:"error","aria-live":"polite"},qe={class:"mb-3"},Re={key:0,class:"error","aria-live":"polite"},Ge={class:"mb-3"},Ke={key:0,class:"error","aria-live":"polite"},Qe={class:"d-flex justify-content-center"},Je={key:1,class:"btn btn-primary",type:"button",disabled:""},We={class:"mb-3"},Xe={key:0,class:"error","aria-live":"polite"},Ye={class:"mb-3"},Ze={key:0,class:"error","aria-live":"polite"},et={class:"mb-3"},tt={key:0,class:"error","aria-live":"polite"},at={class:"mb-3"},st={key:0,class:"error","aria-live":"polite"},lt={class:"d-flex justify-content-center mt-5"},ot={key:1,class:"btn btn-primary",type:"button",disabled:""},nt={__name:"VenueManagement",setup(rt){const te=ye(),U=p(null),D=p(null),g=p({}),{proxy:_}=Ce(),h=ge(),M=p([]),A=p(""),N=p("asc"),ae=p(!1),w=p(1),T=p(1),H=p(20),se=p([20,50]),j=p(""),le=p(""),c=p({}),V=p(!1),Q=p("");Q.value=te.getUserId();const oe=p(50),J={name:"",level_id:"",opening_time:"",closing_time:"",capacity:""},i=p({...J}),ne=()=>{i.value={...J}},W=()=>{ne(),c.value={}},I={enableTime:!0,noCalendar:!0,dateFormat:"H:i",time_24hr:!0,minuteIncrement:10},re=()=>{U.value&&U.value.show()},ie=o=>{D.value&&(X(o),D.value.show())},F=o=>{A.value===o?N.value=N.value==="asc"?"desc":"asc":(A.value=o,N.value="asc")},b=async o=>{var e,s,v,r,f,C,$;try{const u=await h.get(`v1/scheduler/spaces/${Q.value}?page=${o}&per-page=${H.value}&_q=${j.value}`);ae.value=Array.isArray(u.data),M.value=u.data.dataPayload.data,w.value=u.data.dataPayload.currentPage,T.value=u.data.dataPayload.totalPages,oe.value=u.data.dataPayload.perPage}catch(u){const S=((r=(v=(s=(e=u.response)==null?void 0:e.data)==null?void 0:s.errorPayload)==null?void 0:v.errors)==null?void 0:r.message)||(($=(C=(f=u.response)==null?void 0:f.data)==null?void 0:C.errorPayload)==null?void 0:$.message)||"An unknown error occurred";_.$showToast({title:"An error occurred ",text:S,icon:"error"})}};_e(j,()=>{b(1)});const X=async o=>{var e,s,v,r,f,C,$;try{const u=await h.get(`v1/scheduler/space/${o}`);i.value=u.data.dataPayload.data}catch(u){const S=((r=(v=(s=(e=u==null?void 0:u.response)==null?void 0:e.data)==null?void 0:s.errorPayload)==null?void 0:v.errors)==null?void 0:r.message)||(($=(C=(f=u==null?void 0:u.response)==null?void 0:f.data)==null?void 0:C.errorPayload)==null?void 0:$.message)||(u==null?void 0:u.message)||"An unknown error occurred";_.$showToast({title:"An error occurred",text:S,icon:"error"})}},ue=be(()=>[...M.value].sort((o,e)=>{let s=N.value==="asc"?1:-1;return o[A.value]<e[A.value]?-1*s:o[A.value]>e[A.value]?1*s:0})),de=async()=>{var o;try{V.value=!0;const e=await h.post("v1/scheduler/space",i.value);e.data.alertifyPayload?(g.value=e.data.alertifyPayload,U.value.hide(),_.$showAlert({title:g.value.theme,icon:g.value.theme,text:g.value.message,showCancelButton:!1,showConfirmButton:!1,timer:4e3}),i.value={name:"",level_id:"",opening_time:"",closing_time:""},c.value={}):_.$showToast({title:"Created successfully",icon:"success"}),b(1)}catch(e){if(e.response&&e.response.data&&e.response.data.errorPayload)c.value=e.response.data.errorPayload.errors;else{const s=((o=e.response.data.errorPayload.errors)==null?void 0:o.message)||"An unknown error occurred";_.$showToast({title:s,text:s,icon:"error"})}}finally{V.value=!1}},ce=async o=>{var e,s,v;try{V.value=!0;const r=await h.put(`v1/scheduler/space/${o}`,i.value);r.data.alertifyPayload?(b(1),D.value.hide(),g.value=r.data.alertifyPayload,_.$showToast({title:g.value.message||"Updated successfully",icon:"success"})):_.$showAlert({title:"Updated successfully",icon:"success",showCancelButton:!1,showConfirmButton:!1,timer:4e3})}catch(r){if((r==null?void 0:r.response)&&((e=r.response)==null?void 0:e.data)&&((s=r.response)==null?void 0:s.data.errorPayload))c.value=r.response.data.errorPayload.errors;else{const f=((v=r.response.data.errorPayload.errors)==null?void 0:v.message)||"An unknown error occurred";_.$showToast({title:"An error occurred",text:f,icon:"error"})}}finally{V.value=!1}},me=async()=>{await b(H.value)},R=o=>{o>0&&o<=T.value&&(w.value=o,b(o))},ve=async o=>{var e;g.value=null;try{const s=await h.delete(`v1/scheduler/space/${o}`);X(o),b(1),s.data.alertifyPayload?(g.value=s.data.alertifyPayload,_.$showAlert({title:g.value.message,icon:g.value.theme,showCancelButton:!1,showConfirmButton:!1,timer:1500,showprogressBar:!0})):_.$showToast({title:"Space Deleted successfully",icon:"success"})}catch(s){const v=((e=s.response.data.errorPayload.errors)==null?void 0:e.message)||"An unknown error occurred";_.$showToast({title:"An error occurred",text:v,icon:"error"})}},Y=(o,e)=>{le.value=o,_.$showAlert({title:"Are you sure?",text:" Do you want to "+e+" this Space ?",icon:"warning",showCancelButton:!0,confirmButtonText:e,cancelButtonText:"Cancel",confirmButtonColor:"#076232",cancelButtonColor:"#d33"}).then(s=>{s.isConfirmed&&(ve(o),b(1))})},pe=async o=>{var e,s,v,r;try{const f=await h.put(`v1/scheduler/lock-space/${o}`);f.data.alertifyPayload&&(g.value=f.data.alertifyPayload,b(1),_.$showAlert({title:g.value.theme,text:g.value.message,icon:g.value.theme,showCancelButton:!1,showConfirmButton:!1,timer:4e3}))}catch(f){const C=((r=(v=(s=(e=f==null?void 0:f.response)==null?void 0:e.data)==null?void 0:s.errorPayload)==null?void 0:v.errors)==null?void 0:r.message)||"An unknown error occurred";_.$showAlert({title:"An error occurred",text:C,icon:"error",showCancelButton:!0,showConfirmButton:!1}),console.error("Failed to update lock status:",f)}};return ke(async()=>{b(1)}),(o,e)=>{const s=x("b-col"),v=x("b-button"),r=x("b-row"),f=x("b-form-input"),C=x("b-input-group-append"),$=x("b-input-group"),u=x("b-card"),S=x("b-modal");return d(),m(O,null,[l(s,{lg:"12"},{default:n(()=>[l(u,null,{default:n(()=>[l(r,null,{default:n(()=>[l(s,{lg:"6"},{default:n(()=>e[18]||(e[18]=[t("h3",{class:"mb-3"},"Space Management",-1)])),_:1}),l(s,{lg:"6",class:"mb-3"},{default:n(()=>[t("div",Pe,[l(v,{variant:"primary",onClick:re},{default:n(()=>e[19]||(e[19]=[P(" New Space ")])),_:1})])]),_:1})]),_:1}),l(r,{class:"mb-3"},{default:n(()=>[l(s,{lg:"12"},{default:n(()=>[t("div",xe,[t("div",$e,[B(t("select",{id:"itemsPerPage","onUpdate:modelValue":e[0]||(e[0]=a=>H.value=a),onChange:me,class:"form-select form-select-sm"},[(d(!0),m(O,null,K(se.value,a=>(d(),m("option",{key:a,value:a},y(a),9,he))),128))],544),[[we,H.value]])]),t("div",Ae,[l($,null,{default:n(()=>[l(f,{placeholder:"Search...",modelValue:j.value,"onUpdate:modelValue":e[1]||(e[1]=a=>j.value=a)},null,8,["modelValue"]),l(C,null,{default:n(()=>[l(v,{variant:"primary",onClick:e[2]||(e[2]=a=>b())},{default:n(()=>e[20]||(e[20]=[t("i",{class:"fas fa-search"},null,-1)])),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1}),t("div",Ve,[t("table",Se,[t("thead",null,[t("tr",null,[t("th",{onClick:e[3]||(e[3]=a=>F("description"))},e[21]||(e[21]=[P("Name "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[4]||(e[4]=a=>F("start_date"))},e[22]||(e[22]=[P("Opening Hours "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[5]||(e[5]=a=>F("end_date"))},e[23]||(e[23]=[P("Closing Hours "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[6]||(e[6]=a=>F("start_time"))},e[24]||(e[24]=[P("Capacity "),t("i",{class:"fas fa-sort"},null,-1)])),e[25]||(e[25]=t("th",null,"Status",-1)),e[26]||(e[26]=t("th",null,"Actions",-1))])]),t("tbody",null,[Array.isArray(M.value)&&M.value.length>0?(d(!0),m(O,{key:0},K(ue.value,(a,Z)=>(d(),m("tr",{key:Z},[t("td",null,y(a.name),1),t("td",null,y(a.opening_time),1),t("td",null,y(a.closing_time),1),t("td",null,y(a.capacity),1),t("td",null,[t("span",{class:z(a.is_locked?"badge bg-warning":"badge bg-success"),onClick:G=>pe(a.id)},y(a.is_locked?"Locked":"Unlocked"),11,Te)]),t("td",null,[t("button",{class:"btn btn-outline-primary btn-sm me-3",onClick:G=>ie(a.id)},e[27]||(e[27]=[t("i",{class:"fas fa-edit",title:"Edit"},null,-1)]),8,Be),a.is_deleted!==1?(d(),m("button",{key:0,class:"btn btn-outline-danger btn-sm me-3",onClick:G=>Y(a.id,"Delete")},e[28]||(e[28]=[t("i",{class:"fas fa-trash",title:"Delete"},null,-1)]),8,Ue)):k("",!0),a.is_deleted===1?(d(),m("button",{key:1,class:"btn btn-outline-danger btn-sm",onClick:G=>Y(a.id,"Restore")},e[29]||(e[29]=[t("i",{class:"fas fa-undo",title:"Restore"},null,-1)]),8,De)):k("",!0)])]))),128)):(d(),m("tr",Me,e[30]||(e[30]=[t("td",{colspan:"6",class:"text-center"},"No records found.",-1)])))])])]),l(s,{sm:"12",lg:"12",class:"mt-5 d-flex justify-content-end mb-n5"},{default:n(()=>[t("nav",Ne,[t("ul",He,[t("li",{class:z(["page-item",{disabled:w.value===1}])},[t("button",{class:"page-link",onClick:e[7]||(e[7]=a=>R(w.value-1)),disabled:w.value===1},"Previous",8,je)],2),(d(!0),m(O,null,K(T.value,a=>(d(),m("li",{key:a,class:z(["page-item",{active:w.value===a}])},[t("button",{class:"page-link",onClick:Z=>R(a)},y(a),9,Ie)],2))),128)),t("li",{class:z(["page-item",{disabled:w.value===T.value}])},[t("button",{class:"page-link",onClick:e[8]||(e[8]=a=>R(w.value+1)),disabled:w.value===T.value},"Next",8,Fe)],2)])])]),_:1})]),_:1})]),_:1}),l(S,{ref_key:"newSpace",ref:U,title:"New Space",class:"modal-fullscreen my-modal","no-close-on-backdrop":"","no-close-on-esc":"",size:"xl","hide-footer":"",onHide:W},{default:n(()=>[l(r,null,{default:n(()=>[l(s,{md:"12",lg:"6"},{default:n(()=>[t("div",Oe,[e[31]||(e[31]=t("label",{for:"startDatePicker",class:"form-label"},"Name",-1)),B(t("input",{type:"text","onUpdate:modelValue":e[9]||(e[9]=a=>i.value.name=a),class:"form-control",id:"name"},null,512),[[L,i.value.name]])]),c.value.name?(d(),m("div",ze,y(c.value.name),1)):k("",!0)]),_:1}),l(s,{md:"12",lg:"6"},{default:n(()=>[t("div",Le,[e[32]||(e[32]=t("label",{for:"spacecapacity",class:"form-label"},"Capacity",-1)),B(t("input",{type:"text","onUpdate:modelValue":e[10]||(e[10]=a=>i.value.capacity=a),class:"form-control",id:"capacity"},null,512),[[L,i.value.capacity]])]),c.value.capacity?(d(),m("div",Ee,y(c.value.capacity),1)):k("",!0)]),_:1})]),_:1}),l(r,null,{default:n(()=>[l(s,{md:"6"},{default:n(()=>[t("div",qe,[e[33]||(e[33]=t("label",{for:"startTimePicker",class:"form-label"},"Opening Hours",-1)),l(E(q),{modelValue:i.value.opening_time,"onUpdate:modelValue":e[11]||(e[11]=a=>i.value.opening_time=a),class:"form-control",config:I,id:"startTimePicker"},null,8,["modelValue"])]),c.value.opening_time?(d(),m("div",Re,y(c.value.opening_time),1)):k("",!0)]),_:1}),l(s,{md:"5"},{default:n(()=>[t("div",Ge,[e[34]||(e[34]=t("label",{for:"endTimePicker",class:"form-label"},"Closing Hours",-1)),l(E(q),{modelValue:i.value.closing_time,"onUpdate:modelValue":e[12]||(e[12]=a=>i.value.closing_time=a),class:"form-control",config:I,id:"endTimePicker"},null,8,["modelValue"])]),c.value.closing_time?(d(),m("div",Ke,y(c.value.closing_time),1)):k("",!0)]),_:1})]),_:1}),t("div",Qe,[V.value===!1?(d(),ee(v,{key:0,onClick:de,variant:"primary"},{default:n(()=>e[35]||(e[35]=[P("Save")])),_:1})):(d(),m("button",Je,e[36]||(e[36]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1),P(" Saving... ")])))])]),_:1},512),l(S,{ref_key:"editSpace",ref:D,title:"Edit Space",class:"modal-fullscreen my-modal","no-close-on-backdrop":"","no-close-on-esc":"",size:"xl","hide-footer":"",onHide:W},{default:n(()=>[l(r,null,{default:n(()=>[l(s,{md:"12"},{default:n(()=>[t("div",We,[e[37]||(e[37]=t("label",{for:"startDatePicker",class:"form-label"},"Name",-1)),B(t("input",{type:"text","onUpdate:modelValue":e[13]||(e[13]=a=>i.value.name=a),class:"form-control",id:"name"},null,512),[[L,i.value.name]])]),c.value.name?(d(),m("div",Xe,y(c.value.name),1)):k("",!0)]),_:1})]),_:1}),l(r,null,{default:n(()=>[l(s,{md:"6"},{default:n(()=>[t("div",Ye,[e[38]||(e[38]=t("label",{for:"startTimePicker",class:"form-label"},"Opening Hours",-1)),l(E(q),{modelValue:i.value.opening_time,"onUpdate:modelValue":e[14]||(e[14]=a=>i.value.opening_time=a),class:"form-control",config:I,id:"startTimePicker"},null,8,["modelValue"])]),c.value.opening_time?(d(),m("div",Ze,y(c.value.opening_time),1)):k("",!0)]),_:1}),l(s,{md:"6"},{default:n(()=>[t("div",et,[e[39]||(e[39]=t("label",{for:"endTimePicker",class:"form-label"},"Closing Hours",-1)),l(E(q),{modelValue:i.value.closing_time,"onUpdate:modelValue":e[15]||(e[15]=a=>i.value.closing_time=a),class:"form-control",config:I,id:"endTimePicker"},null,8,["modelValue"])]),c.value.closing_time?(d(),m("div",tt,y(c.value.closing_time),1)):k("",!0)]),_:1})]),_:1}),l(r,null,{default:n(()=>[l(s,{md:"12"},{default:n(()=>[t("div",at,[e[40]||(e[40]=t("label",{for:"capacity",class:"form-label"},"Capacity",-1)),B(t("input",{type:"text","onUpdate:modelValue":e[16]||(e[16]=a=>i.value.capacity=a),class:"form-control",id:"capacity"},null,512),[[L,i.value.capacity]])]),c.value.capacity?(d(),m("div",st,y(c.value.capacity),1)):k("",!0)]),_:1})]),_:1}),t("div",lt,[V.value===!1?(d(),ee(v,{key:0,onClick:e[17]||(e[17]=a=>ce(i.value.id)),variant:"primary"},{default:n(()=>e[41]||(e[41]=[P("Update")])),_:1})):(d(),m("button",ot,e[42]||(e[42]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1),P(" Updating... ")])))])]),_:1},512)],64)}}};var mt=fe(nt,[["__scopeId","data-v-5e623eee"]]);export{mt as default};
