import{_ as fe,k as pe,j as c,A as ye,y as _e,q as be,r as g,o as d,c as u,d as l,w as r,b as t,e as k,m as ge,D as ke,F as I,C as q,G as Y,l as P,t as v,n as y,p as Pe}from"./index.e0205fad.js";import{C as w}from"./component.da87e159.js";import"./pdfjs.7adb8c57.js";import"./index.f7b24e3d.js";const we={class:"d-flex justify-content-end"},Ae={class:"d-flex justify-content-between"},Ve={class:"d-flex align-items-center"},Ce=["value"],Te={class:"d-flex align-items-center"},xe={class:"table-responsive"},De={class:"table table-hover"},$e=["onClick"],Se=["onClick"],Ue={key:1},Me={"aria-label":"Page navigation"},he={class:"pagination justify-content-end"},Be=["disabled"],Ee=["onClick"],Fe=["disabled"],Ne={class:"mb-3"},je={key:0,class:"error","aria-live":"polite"},Ie={class:"mb-3"},Le={key:0,class:"error","aria-live":"polite"},ze={class:"mb-3"},He={key:0,class:"error","aria-live":"polite"},Oe={class:"mb-3"},qe={key:0,class:"error","aria-live":"polite"},Ye={key:0,class:"error","aria-live":"polite"},Ge={class:"d-flex justify-content-end"},Ke={class:"mb-3"},Qe={key:0,class:"error","aria-live":"polite"},Je={class:"mb-3"},Re={key:0,class:"error","aria-live":"polite"},We={class:"mb-3"},Xe={key:0,class:"error","aria-live":"polite"},Ze={class:"mb-3"},et={key:0,class:"error","aria-live":"polite"},tt={key:0,class:"error","aria-live":"polite"},at={class:"d-flex justify-content-end"},lt={__name:"AvailabilityView",setup(st){const R=pe(),D=c(null),$=c(null),A=c({}),L=c("");L.value=R.getUserId();const W=c(50),i=c({user_id:L.value,start_date:"",end_date:"",start_time:"",end_time:"",description:""}),h={enableTime:!1,dateFormat:"Y-m-d",disable:[function(o){return o.getDay()===6||o.getDay()===0}]},B={enableTime:!0,noCalendar:!0,dateFormat:"H:i",time_24hr:!0,minuteIncrement:10},X=()=>{D.value&&D.value.show()},Z=()=>{D.value&&D.value.hide()},ee=o=>{$.value&&(ie(o),$.value.show())},te=()=>{$.value&&$.value.hide()},{proxy:m}=Pe(),V=ye(),S=c([]),C=c(""),E=c("asc"),G=c(!1),_=c(1),U=c(1),z=c(20),ae=c([20,50]),H=c(""),le=c(""),n=c({}),M=o=>{C.value===o?E.value=E.value==="asc"?"desc":"asc":(C.value=o,E.value="asc")},se=()=>{i.value={user_id:L.value,start_date:"",end_date:"",start_time:"",end_time:"",description:""},n.value={}},K=()=>{se()},oe=async()=>{try{const o=await V.get(`v1/scheduler/availabilities?_q=${H.value}`);G.value=Array.isArray(o.data),S.value=o.data.dataPayload.data}catch{m.$showToast({title:"An error occurred",text:"Ooops! an error occured",icon:"error"})}},re=o=>{le.value=o,m.$showAlert({title:"Are you sure?",text:"You are about to DELETE this entry. Do you want to proceed?",icon:"warning",showCancelButton:!0,confirmButtonText:"Delete",cancelButtonText:"Cancel",confirmButtonColor:"#076232",cancelButtonColor:"#d33"}).then(e=>{e.isConfirmed&&(ne(o),T(1))})},ne=async o=>{var e;try{const s=await V.delete(`v1/scheduler/availability/${o}`);s.data.alertifyPayload?(A.value=s.data.alertifyPayload,m.$showToast({title:A.value.message||"operation successful",icon:"success"})):m.$showToast({title:"operation successful",icon:"success"}),T(1)}catch(s){const f=((e=s.response.data.errorPayload.errors)==null?void 0:e.message)||"An unknown error occurred";m.$showToast({title:"An error occurred",text:f,icon:"error"})}},T=async(o=1)=>{var e,s,f,b,x,F,N;try{const p=await V.get(`v1/scheduler/availabilities?page=${o}&per-page=${z.value}`);G.value=Array.isArray(p.data),S.value=p.data.dataPayload.data,_.value=p.data.dataPayload.currentPage,U.value=p.data.dataPayload.totalPages,W.value=p.data.dataPayload.perPage}catch(p){const j=((b=(f=(s=(e=p.response)==null?void 0:e.data)==null?void 0:s.errorPayload)==null?void 0:f.errors)==null?void 0:b.message)||((N=(F=(x=p.response)==null?void 0:x.data)==null?void 0:F.errorPayload)==null?void 0:N.message)||"An unknown error occurred";m.$showToast({title:"An error occurred ",text:j,icon:"error"})}},ie=async o=>{var e;try{const s=await V.get(`v1/scheduler/availability/${o}`);i.value=s.data.dataPayload.data}catch(s){const f=((e=s.response.data.errorPayload.errors)==null?void 0:e.message)||"An unknown error occurred";m.$showToast({title:"An error occurred",text:f,icon:"error"})}},de=_e(()=>[...S.value].sort((o,e)=>{let s=E.value==="asc"?1:-1;return o[C.value]<e[C.value]?-1*s:o[C.value]>e[C.value]?1*s:0})),ue=async()=>{var o;try{const e=await V.post("v1/scheduler/availability",i.value);Z(),e.data.alertifyPayload?(A.value=e.data.alertifyPayload,m.$showToast({title:A.value.message||"created successfully",icon:"success"})):m.$showToast({title:"Created successfully",icon:"success"}),T(1)}catch(e){if(e.response&&e.response.data&&e.response.data.errorPayload)n.value=e.response.data.errorPayload.errors;else{const s=((o=e.response.data.errorPayload.errors)==null?void 0:o.message)||"An unknown error occurred";m.$showToast({title:s,text:s,icon:"error"})}}},ce=async o=>{try{const e=await V.put(`v1/scheduler/availability/${o}`,i.value);te(),e.data.alertifyPayload?(A.value=e.data.alertifyPayload,m.$showToast({title:A.value.message||"Updated successfully",icon:"success"})):m.$showToast({title:"Updated successfully",icon:"success"})}catch(e){let s="An error occurred";e.response&&e.response.data.errorPayload&&(n.value=e.response.data.errorPayload.errors,n.value&&n.value.message&&(s=n.value.message)),m.$showToast({title:s,text:s,icon:"error"})}},ve=async()=>{await T(1)},O=o=>{o>0&&o<=U.value&&(_.value=o,T(o))};return be(async()=>{T(1)}),(o,e)=>{const s=g("b-col"),f=g("b-button"),b=g("b-row"),x=g("b-form-input"),F=g("b-input-group-append"),N=g("b-input-group"),p=g("b-card"),j=g("b-form-group"),Q=g("b-modal");return d(),u(I,null,[l(s,{lg:"12"},{default:r(()=>[l(p,null,{default:r(()=>[l(b,null,{default:r(()=>[l(s,{lg:"6"},{default:r(()=>e[20]||(e[20]=[t("div",null,[t("h2",null,"Availability")],-1)])),_:1}),l(s,{lg:"6"},{default:r(()=>[t("div",we,[l(f,{variant:"primary",onClick:X},{default:r(()=>e[21]||(e[21]=[k(" New Availability ")])),_:1})])]),_:1})]),_:1}),l(b,{class:"mb-3"},{default:r(()=>[l(s,{lg:"12"},{default:r(()=>[t("div",Ae,[t("div",Ve,[ge(t("select",{id:"itemsPerPage","onUpdate:modelValue":e[0]||(e[0]=a=>z.value=a),onChange:ve,class:"form-select form-select-sm"},[(d(!0),u(I,null,q(ae.value,a=>(d(),u("option",{key:a,value:a},v(a),9,Ce))),128))],544),[[ke,z.value]])]),t("div",Te,[l(N,null,{default:r(()=>[l(x,{placeholder:"Search...",modelValue:H.value,"onUpdate:modelValue":e[1]||(e[1]=a=>H.value=a)},null,8,["modelValue"]),l(F,null,{default:r(()=>[l(f,{variant:"primary",onClick:oe},{default:r(()=>e[22]||(e[22]=[k("Search")])),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1}),t("div",xe,[t("table",De,[t("thead",null,[t("tr",null,[t("th",{onClick:e[2]||(e[2]=a=>M("description"))},e[23]||(e[23]=[k("Description "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[3]||(e[3]=a=>M("start_date"))},e[24]||(e[24]=[k("Start Date "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[4]||(e[4]=a=>M("end_date"))},e[25]||(e[25]=[k("End Date "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[5]||(e[5]=a=>M("start_time"))},e[26]||(e[26]=[k("Start Time "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[6]||(e[6]=a=>M("end_time"))},e[27]||(e[27]=[k("End Time "),t("i",{class:"fas fa-sort"},null,-1)])),e[28]||(e[28]=t("th",null,"Actions",-1))])]),t("tbody",null,[Array.isArray(S.value)&&S.value.length>0?(d(!0),u(I,{key:0},q(de.value,(a,J)=>(d(),u("tr",{key:J},[t("td",null,v(a.description),1),t("td",null,v(a.start_date),1),t("td",null,v(a.end_date),1),t("td",null,v(a.start_time),1),t("td",null,v(a.end_time),1),t("td",null,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm me-3",onClick:me=>ee(a.id)},e[29]||(e[29]=[t("i",{class:"fas fa-edit",title:"edit entry"},null,-1)]),8,$e),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:me=>re(a.id)},e[30]||(e[30]=[t("i",{class:"fas fa-trash",title:"delete entry"},null,-1)]),8,Se)])]))),128)):(d(),u("tr",Ue,e[31]||(e[31]=[t("td",{colspan:"6",class:"text-center"},"No records found.",-1)])))])])]),l(s,{sm:"12",lg:"12",class:"mt-5 d-flex justify-content-end mb-n5"},{default:r(()=>[t("nav",Me,[t("ul",he,[t("li",{class:Y(["page-item",{disabled:_.value===1}])},[t("button",{class:"page-link",onClick:e[7]||(e[7]=a=>O(_.value-1)),disabled:_.value===1},"Previous",8,Be)],2),(d(!0),u(I,null,q(U.value,a=>(d(),u("li",{key:a,class:Y(["page-item",{active:_.value===a}])},[t("button",{class:"page-link",onClick:J=>O(a)},v(a),9,Ee)],2))),128)),t("li",{class:Y(["page-item",{disabled:_.value===U.value}])},[t("button",{class:"page-link",onClick:e[8]||(e[8]=a=>O(_.value+1)),disabled:_.value===U.value},"Next",8,Fe)],2)])])]),_:1})]),_:1})]),_:1}),l(Q,{ref_key:"newAvailability",ref:D,title:"New Availability",class:"modal-fullscreen my-modal","no-close-on-backdrop":"","no-close-on-esc":"",size:"xl","hide-footer":"",onHide:K},{default:r(()=>[e[37]||(e[37]=t("h4",null,"Availability Settings",-1)),l(b,null,{default:r(()=>[l(s,{md:"12"},{default:r(()=>[t("div",Ne,[e[32]||(e[32]=t("label",{for:"startDatePicker",class:"form-label"},"Start Date",-1)),l(P(w),{modelValue:i.value.start_date,"onUpdate:modelValue":e[9]||(e[9]=a=>i.value.start_date=a),class:"form-control",config:h,id:"startDatePicker"},null,8,["modelValue"])]),n.value.start_date?(d(),u("div",je,v(n.value.start_date),1)):y("",!0)]),_:1}),l(s,{md:"12"},{default:r(()=>[t("div",Ie,[e[33]||(e[33]=t("label",{for:"endDatePicker",class:"form-label"},"Last Date",-1)),l(P(w),{modelValue:i.value.end_date,"onUpdate:modelValue":e[10]||(e[10]=a=>i.value.end_date=a),class:"form-control",config:h,id:"endDatePicker"},null,8,["modelValue"])]),n.value.end_date?(d(),u("div",Le,v(n.value.end_date),1)):y("",!0)]),_:1})]),_:1}),l(b,null,{default:r(()=>[l(s,{md:"6"},{default:r(()=>[t("div",ze,[e[34]||(e[34]=t("label",{for:"startTimePicker",class:"form-label"},"Start Time",-1)),l(P(w),{modelValue:i.value.start_time,"onUpdate:modelValue":e[11]||(e[11]=a=>i.value.start_time=a),class:"form-control",config:B,id:"startTimePicker"},null,8,["modelValue"])]),n.value.start_time?(d(),u("div",He,v(n.value.start_time),1)):y("",!0)]),_:1}),l(s,{md:"5"},{default:r(()=>[t("div",Oe,[e[35]||(e[35]=t("label",{for:"endTimePicker",class:"form-label"},"End Time",-1)),l(P(w),{modelValue:i.value.end_time,"onUpdate:modelValue":e[12]||(e[12]=a=>i.value.end_time=a),class:"form-control",config:B,id:"endTimePicker"},null,8,["modelValue"])]),n.value.end_time?(d(),u("div",qe,v(n.value.end_time),1)):y("",!0)]),_:1}),l(s,{md:"12",class:"mb-3"},{default:r(()=>[l(j,{label:"Description","label-for":"descriptionField"},{default:r(()=>[l(x,{id:"descriptionField",type:"text",modelValue:i.value.description,"onUpdate:modelValue":e[13]||(e[13]=a=>i.value.description=a)},null,8,["modelValue"]),n.value.description?(d(),u("div",Ye,v(n.value.description),1)):y("",!0)]),_:1})]),_:1})]),_:1}),t("div",Ge,[l(f,{onClick:ue,variant:"primary"},{default:r(()=>e[36]||(e[36]=[k("Save")])),_:1})])]),_:1},512),l(Q,{ref_key:"updateAvailability",ref:$,title:"update Availability",class:"modal-fullscreen my-modal","no-close-on-backdrop":"","no-close-on-esc":"",size:"xl","hide-footer":"",onHide:K},{default:r(()=>[e[43]||(e[43]=t("h4",null,"Availability Settings",-1)),l(b,null,{default:r(()=>[l(s,{md:"12"},{default:r(()=>[t("div",Ke,[e[38]||(e[38]=t("label",{for:"startDatePicker",class:"form-label"},"Start Date",-1)),l(P(w),{modelValue:i.value.start_date,"onUpdate:modelValue":e[14]||(e[14]=a=>i.value.start_date=a),class:"form-control",config:h,id:"startDatePicker"},null,8,["modelValue"])]),n.value.start_date?(d(),u("div",Qe,v(n.value.start_date),1)):y("",!0)]),_:1}),l(s,{md:"12"},{default:r(()=>[t("div",Je,[e[39]||(e[39]=t("label",{for:"endDatePicker",class:"form-label"},"Last Date",-1)),l(P(w),{modelValue:i.value.end_date,"onUpdate:modelValue":e[15]||(e[15]=a=>i.value.end_date=a),class:"form-control",config:h,id:"endDatePicker"},null,8,["modelValue"])]),n.value.end_date?(d(),u("div",Re,v(n.value.end_date),1)):y("",!0)]),_:1})]),_:1}),l(b,null,{default:r(()=>[l(s,{md:"6"},{default:r(()=>[t("div",We,[e[40]||(e[40]=t("label",{for:"startTimePicker",class:"form-label"},"Start Time",-1)),l(P(w),{modelValue:i.value.start_time,"onUpdate:modelValue":e[16]||(e[16]=a=>i.value.start_time=a),class:"form-control",config:B,id:"startTimePicker"},null,8,["modelValue"])]),n.value.start_time?(d(),u("div",Xe,v(n.value.start_time),1)):y("",!0)]),_:1}),l(s,{md:"5"},{default:r(()=>[t("div",Ze,[e[41]||(e[41]=t("label",{for:"endTimePicker",class:"form-label"},"End Time",-1)),l(P(w),{modelValue:i.value.end_time,"onUpdate:modelValue":e[17]||(e[17]=a=>i.value.end_time=a),class:"form-control",config:B,id:"endTimePicker"},null,8,["modelValue"])]),n.value.end_time?(d(),u("div",et,v(n.value.end_time),1)):y("",!0)]),_:1}),l(s,{md:"12",class:"mb-3"},{default:r(()=>[l(j,{label:"Description","label-for":"descriptionField"},{default:r(()=>[l(x,{id:"descriptionField",type:"text",modelValue:i.value.description,"onUpdate:modelValue":e[18]||(e[18]=a=>i.value.description=a)},null,8,["modelValue"]),n.value.description?(d(),u("div",tt,v(n.value.description),1)):y("",!0)]),_:1})]),_:1})]),_:1}),t("div",at,[l(f,{onClick:e[19]||(e[19]=a=>ce(i.value.id)),variant:"primary"},{default:r(()=>e[42]||(e[42]=[k("Update")])),_:1})])]),_:1},512)],64)}}};var dt=fe(lt,[["__scopeId","data-v-73bb5d50"]]);export{dt as default};
