import{A as Y,j as m,z as q,r as w,o as d,g as A,w as i,d as r,b as o,m as B,v as U,c as v,t as f,n as _,l as k,e as N,p as O}from"./index.e0205fad.js";import{C as V}from"./component.da87e159.js";const G={class:"mb-3"},J={key:0,class:"error","aria-live":"polite"},K={class:"mb-3"},L={key:0,class:"error","aria-live":"polite"},Q={class:"mb-3"},R={key:0,class:"error","aria-live":"polite"},W={class:"mb-3"},X={key:0,class:"error","aria-live":"polite"},Z={class:"mb-3"},ee={key:0,class:"error","aria-live":"polite"},te={class:"mb-3"},oe={key:0,class:"error","aria-live":"polite"},ae={class:"d-flex justify-content-center"},le={key:1,class:"btn btn-primary",type:"button",disabled:""},ne={__name:"viewEvent",props:{event_id:{type:Number,required:!0}},emits:["getEvents"],setup($,{expose:F,emit:S}){const D=Y(),I=S,{proxy:P}=O(),T=$,c=m(T.event_id);q(()=>T.event_id,a=>{console.log("New event_id:",a),c.value=a},{immediate:!0});const s=m({}),b=m(!1),C=m({label:"ACTIVE"}),E={dateFormat:"Y-m-d",altInput:!0,altFormat:"F j, Y",minDate:"today",disable:[function(a){return a.getDay()===6||a.getDay()===0}]},h={enableTime:!0,noCalendar:!0,dateFormat:"H:i",time_24hr:!0},t=m({title:"",start_date:"",end_date:"",start_time:"",end_time:"",description:""}),y=m(null),M=async a=>{var e;if(a&&(c.value=a),console.log("Opening modal with event_id:",c.value),!c.value){console.error("Error: event_id is null or undefined");return}await z(),(e=y.value)==null||e.show()},j=()=>{console.log("Modal closed"),t.value={title:"",start_date:"",end_date:"",start_time:"",end_time:"",description:""},s.value={}},x=m({}),z=async()=>{var a,e,n,p,g;try{console.log("Fetching event:",c.value);const u=await D.get(`v1/scheduler/events/${c.value}`);t.value=u.data.dataPayload.data,C.value=t.value.recordStatus}catch(u){console.error("Error fetching event:",u),(a=y.value)==null||a.hide();const l=(g=(p=(n=(e=u==null?void 0:u.response)==null?void 0:e.data)==null?void 0:n.errorPayload)==null?void 0:p.errors)==null?void 0:g.message;P.$showToast({title:l,text:l,icon:"error"})}},H=async()=>{var a;try{b.value=!0;const e=await D.put(`v1/scheduler/events/${t.value.id}`,t.value);I("getEvents"),y.value.hide(),e.data.alertifyPayload&&(x.value=e.data.alertifyPayload,P.$showAlert({title:x.value.message,icon:x.value.theme,showCancelButton:!1,showConfirmButton:!1,timer:4e3,timerProgressBar:!0}))}catch(e){if(b.value=!1,e.response&&e.response.data.errorPayload)s.value=e.response.data.errorPayload.errors;else{const n=((a=e.response.data.errorPayload.errors)==null?void 0:a.message)||"An error occurred";P.$showToast({title:"An error occurred",text:n,icon:"error"})}}finally{b.value=!1}};return F({show:M}),(a,e)=>{const n=w("b-col"),p=w("b-row"),g=w("b-button"),u=w("b-modal");return d(),A(u,{ref_key:"editevent",ref:y,title:"Edit Event",class:"p-4 custom-modal-body","no-close-on-backdrop":"","no-close-on-esc":"",size:"xl","hide-footer":"",onHide:j},{default:i(()=>[r(p,null,{default:i(()=>[r(n,{md:"12"},{default:i(()=>[o("div",G,[e[7]||(e[7]=o("label",{for:"startDatePicker",class:"form-label"},"Title",-1)),B(o("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>t.value.title=l),class:"form-control",id:"name"},null,512),[[U,t.value.title]])]),s.value.title?(d(),v("div",J,f(s.value.title),1)):_("",!0)]),_:1})]),_:1}),r(p,null,{default:i(()=>[r(n,{md:"12",lg:"6"},{default:i(()=>[o("div",K,[e[8]||(e[8]=o("label",{for:"levelDropdown",class:"form-label"},"Start Date ",-1)),r(k(V),{modelValue:t.value.start_date,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.start_date=l),class:"form-control",config:E,id:"startDatePicker"},null,8,["modelValue"])]),s.value.date?(d(),v("div",L,f(s.value.start_date),1)):_("",!0)]),_:1}),r(n,{md:"12",lg:"6"},{default:i(()=>[o("div",Q,[e[9]||(e[9]=o("label",{for:"levelDropdown",class:"form-label"},"End Date ",-1)),r(k(V),{modelValue:t.value.end_date,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.end_date=l),class:"form-control",config:E,id:"startDatePicker"},null,8,["modelValue"])]),s.value.event_date?(d(),v("div",R,f(s.value.event_date),1)):_("",!0)]),_:1})]),_:1}),r(p,null,{default:i(()=>[r(n,{md:"6"},{default:i(()=>[o("div",W,[e[10]||(e[10]=o("label",{for:"startTimePicker",class:"form-label"},"Start Time",-1)),r(k(V),{modelValue:t.value.start_time,"onUpdate:modelValue":e[3]||(e[3]=l=>t.value.start_time=l),class:"form-control",config:h,id:"startTimePicker"},null,8,["modelValue"])]),s.value.start_time?(d(),v("div",X,f(s.value.start_time),1)):_("",!0)]),_:1}),r(n,{md:"5"},{default:i(()=>[o("div",Z,[e[11]||(e[11]=o("label",{for:"endTimePicker",class:"form-label"},"End Time",-1)),r(k(V),{modelValue:t.value.end_time,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.end_time=l),class:"form-control",config:h,id:"endTimePicker"},null,8,["modelValue"])]),s.value.end_time?(d(),v("div",ee,f(s.value.end_time),1)):_("",!0)]),_:1}),r(n,{md:"12"},{default:i(()=>[o("div",te,[e[12]||(e[12]=o("label",{for:"description",class:"form-label"},"Description",-1)),B(o("textarea",{"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.description=l),class:"form-control",id:"description",rows:"5"},null,512),[[U,t.value.description]])]),s.value.description?(d(),v("div",oe,f(s.value.description),1)):_("",!0)]),_:1})]),_:1}),o("div",ae,[b.value===!1?(d(),A(g,{key:0,onClick:e[6]||(e[6]=l=>H()),variant:"primary",disabled:C.value.label!=="ACTIVE"},{default:i(()=>e[13]||(e[13]=[N("Update")])),_:1},8,["disabled"])):(d(),v("button",le,e[14]||(e[14]=[o("span",{class:"spinner-grow spinner-grow-sm",role:"status","aria-hidden":"true"},null,-1),N(" submitting... ")])))])]),_:1},512)}}};export{ne as _};
