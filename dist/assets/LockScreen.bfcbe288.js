import{_ as C,i as I,j as c,k as T,u as A,A as L,r as i,o as m,c as _,d as u,w as d,b as s,t as v,l as V,m as B,v as E,n as M,p as j}from"./index.16224396.js";import{_ as D}from"./01.e8096b20.js";import"./pdfjs.7adb8c57.js";const N={class:"backimg"},$={class:"m-4 m"},F={class:"form-group me-3"},H={key:0,class:"error","aria-live":"polite"},O={__name:"LockScreen",setup(U){const f=I(),p=c(!1),r=c(""),a=c({password:"",general:""}),w=T(),n=A(),g=L(),{proxy:l}=j(),t=localStorage.getItem("user.username");function h(){f.navigateToFirstMenu(n)}const y=async()=>{try{await g.logout(),n.push("/auth/login")}catch(e){console.error("Error during logout:",e)}},b=async()=>{a.value={username:"",password:"",general:""},console.log("usernameee:",t),t===null&&(localStorage.clear(),n.push("/auth/login"));try{p.value=!0;const e=await g.post("/v1/iam/auth/login",{username:t,password:r.value});if(e.data.dataPayload&&!e.data.dataPayload.error){const o=e.headers["set-cookie"];console.log("Cookie received:",o),document.cookie=o,localStorage.setItem("loggedIn",!0),l.$showToast({title:"success",text:"You have successfully logged in!",icon:"success"}),w.setToken(e.data.dataPayload.data.access_token,e.data.dataPayload.data.username),h()}else l.$showToast({title:"An error occurred ",text:"Ooops! an error has occured while logging in!",icon:"error"})}catch(e){if(console.log("Error:",e),l.$showToast({title:"An error occurred ",text:"Ooops! an error has occured while logging in!",icon:"error"}),e.response&&e.response.status===422&&e.response.data.errorPayload){const o=e.response.data.errorPayload.errors;console.log("Validation error details:",o),a.value.password=o.password||""}}finally{p.value=!1}};return(e,o)=>{const k=i("b-card"),x=i("b-col"),S=i("b-row");return m(),_("section",N,[u(S,{class:"align-items-center justify-content-center vh-100 w-100"},{default:d(()=>[u(x,{cols:"10",lg:"6"},{default:d(()=>[u(k,{class:"text-center p-5 rounded-3 bg-aliceblue",style:{"min-height":"400px"}},{default:d(()=>[o[1]||(o[1]=s("img",{src:D,alt:"User-Profile",class:"theme-color-default-img img-fluid avatar avatar-50 avatar-rounded",loading:"lazy"},null,-1)),s("h4",$,"Hi ! "+v(V(t)),1),o[2]||(o[2]=s("p",null,"Your session is locked. Please enter your password to continue.",-1)),s("div",F,[B(s("input",{type:"password",class:"form-control mb-0",id:"password","onUpdate:modelValue":o[0]||(o[0]=P=>r.value=P),placeholder:"Enter password","aria-label":"Password",autocomplete:"off"},null,512),[[E,r.value]]),a.value.password?(m(),_("div",H,v(a.value.password),1)):M("",!0)]),s("div",{class:"d-flex w-100 justify-content-center gap-5"},[s("button",{class:"btn btn-outline-primary",onClick:b},"Login"),s("button",{class:"btn btn-outline-warning",onClick:y},"go Back")])]),_:1})]),_:1})]),_:1})])}}};var q=C(O,[["__scopeId","data-v-7fdbbcce"]]);export{q as default};
