import{j as r,A as G,y as Q,z as H,q as W,r as g,o as d,g as X,w as p,d as i,b as t,m as Y,c as f,F as x,C as A,t as m,D as Z,e as C,n as ee,G as T,p as te}from"./index.e0205fad.js";const oe={class:"d-flex justify-content-between"},ae={class:"d-flex align-items-center"},ne=["value"],se={class:"d-flex align-items-center"},re={class:"table-responsive"},le={class:"table table-hover"},ie=["onClick"],ue=["onClick"],ce={key:1},de={"aria-label":"Page navigation"},pe={class:"pagination justify-content-end"},me=["disabled"],ve=["onClick"],fe=["disabled"],ye={__name:"spacesMiniTable",setup(ge){const v=r(""),{proxy:l}=te(),h=G(),P=r([]),_=r(""),E=r("asc"),N=r(!1),u=r(1),b=r(1),V=r(20),w=r(20),D=r([20,50]),y=r(""),$=r({}),R=async()=>{await c(w.value)},k=n=>{n>0&&n<=b.value&&(u.value=n,c(n))},S=async()=>{await c(1)},M=Q(()=>[...P.value].sort((n,e)=>{let a=E.value==="asc"?1:-1;return n[_.value]<e[_.value]?-1*a:n[_.value]>e[_.value]?1*a:0})),c=async n=>{try{const e={page:n,"per-page":w.value};y.value&&(e._search=y.value);const a=await h.get("/v1/scheduler/pending-appointments",{params:e});P.value=a.data.dataPayload.data,u.value=a.data.current_page,b.value=a.data.last_page,V.value=a.data.per_page,N.value=Array.isArray(a.data.data)}catch(e){if(console.error(e),e.response&&e.response.data&&e.response.data.errorPayload)$.value=e.response.data.errorPayload.errors;else{const a=e.message||"An unknown error occurred";l.$showToast({title:"An error occurred",text:a,icon:"error"})}}};H(y,()=>{c(1)});const I=async n=>{var e;try{const a=await h.put(`v1/scheduler/approve/${n}`);c(1),a.data.alertifyPayload?(v.value=a.data.alertifyPayload,l.$showAlert({title:v.value.theme,icon:v.value.theme,text:v.value.message,showCancelButton:!1,showConfirmButton:!1,timer:4e3,timerProgressBar:!0})):l.$showToast({title:"operation successful",icon:"success"}),c(1)}catch(a){const s=(e=a.response.data.errorPayload.errors)==null?void 0:e.message;l.$showToast({title:"An error occurred",text:s,icon:"error"})}},O=async n=>{l.$showAlert({title:"APPROVE",text:"Do you want to proceed?",icon:"warning",showCancelButton:!0,confirmButtonText:"Proceed",cancelButtonText:"Cancel",confirmButtonColor:"#076232",cancelButtonColor:"#d33"}).then(e=>{e.isConfirmed&&I(n)})},q=async(n,e)=>{var a;try{const s=await h.put(`v1/scheduler/reject/${n}`,{rejection_reason:e});s.data.alertifyPayload?(v.value=s.data.alertifyPayload,l.$showAlert({title:v.value.theme,icon:v.value.theme,text:v.value.message,showCancelButton:!1,showConfirmButton:!1,timer:4e3,timerProgressBar:!0})):l.$showToast({title:"operation successful",icon:"success"}),c(1)}catch(s){if(s.response&&s.response.data.errorPayload)$.value=s.response.data.errorPayload.errors;else{const B=(a=s.response.data.errorPayload.errors)==null?void 0:a.message;l.$showToast({title:"An error occurred",text:B,icon:"error"})}}},F=n=>{l.$showAlert({title:"REJECT",text:"By rejecting to grant permission the meeting will be CANCELLED. Do you want to proceed?",icon:"warning",showCancelButton:!0,confirmButtonText:"Proceed",cancelButtonText:"Cancel",confirmButtonColor:"#076232",cancelButtonColor:"#d33"}).then(e=>{if(e.isConfirmed){const a=()=>{l.$showAlert({title:"REJECT",text:"Please provide a reason for rejecting the request",input:"text",inputPlaceholder:"reason",inputAttributes:{maxlength:100},showCancelButton:!0,confirmButtonText:"Reject",cancelButtonText:"Cancel",confirmButtonColor:"#076232",cancelButtonColor:"#d33"}).then(s=>{s.isConfirmed&&(!s.value||s.value.trim()===""?l.$showAlert({title:"Invalid Input",text:"Reason cannot be empty. Please provide a valid reason.",icon:"error",confirmButtonText:"OK",confirmButtonColor:"#d33",showCancelButton:!1}).then(()=>{a()}):(q(n,s.value.trim()),c(1)))})};a()}})};return W(()=>{c(1)}),(n,e)=>{const a=g("b-col"),s=g("b-form-input"),B=g("b-button"),J=g("b-input-group-append"),L=g("b-input-group"),z=g("b-row"),K=g("b-card");return d(),X(a,{lg:"12"},{default:p(()=>[i(K,null,{default:p(()=>[i(a,{lg:"6"},{default:p(()=>e[9]||(e[9]=[t("div",null,[t("h2",null,"Space Requests")],-1)])),_:1}),i(z,{class:"mb-3"},{default:p(()=>[i(a,{lg:"12",class:"mb-3"}),i(a,{lg:"12"},{default:p(()=>[t("div",oe,[t("div",ae,[Y(t("select",{id:"itemsPerPage","onUpdate:modelValue":e[0]||(e[0]=o=>w.value=o),onChange:R,class:"form-select form-select-sm"},[(d(!0),f(x,null,A(D.value,o=>(d(),f("option",{key:o,value:o},m(o),9,ne))),128))],544),[[Z,w.value]])]),t("div",se,[i(L,null,{default:p(()=>[i(s,{placeholder:"Search...",modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=o=>y.value=o)},null,8,["modelValue"]),i(J,null,{default:p(()=>[i(B,{variant:"primary",onClick:S},{default:p(()=>e[10]||(e[10]=[C("Search")])),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1}),t("div",re,[t("table",le,[t("thead",null,[t("tr",null,[e[15]||(e[15]=t("th",null,"Space",-1)),t("th",{onClick:e[2]||(e[2]=o=>n.sortTable("appointment_date"))},"Date"),t("th",{onClick:e[3]||(e[3]=o=>n.sortTable("start_time"))},e[11]||(e[11]=[C("Time "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[4]||(e[4]=o=>n.sortTable("subject"))},e[12]||(e[12]=[C("Subject "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[5]||(e[5]=o=>n.sortTable("userName"))},e[13]||(e[13]=[C("ChairPerson "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[6]||(e[6]=o=>n.sortTable("contact_name"))},e[14]||(e[14]=[C("Contact Name "),t("i",{class:"fas fa-sort"},null,-1)])),e[16]||(e[16]=t("th",null,"Actions",-1))])]),t("tbody",null,[Array.isArray(P.value)&&P.value.length>0?(d(!0),f(x,{key:0},A(M.value,(o,j)=>(d(),f("tr",{key:j},[t("td",null,m(o.space.name),1),t("td",null,m(o.appointment_date),1),t("td",null,m(o.start_time)+"- "+m(o.end_time),1),t("td",null,m(o.subject),1),t("td",null,m(o.userName),1),t("td",null,m(o.contact_name),1),t("td",null,[t("button",{class:"btn btn-outline-primary btn-sm me-3",onClick:U=>O(o.id)},e[17]||(e[17]=[t("i",{class:"fas fa-check",title:"APPROVE"},null,-1)]),8,ie),o.is_deleted!=="1"?(d(),f("button",{key:0,class:"btn btn-outline-danger btn-sm me-3",onClick:U=>F(o.id)},e[18]||(e[18]=[t("i",{class:"fas fa-ban",title:"REJECT"},null,-1)]),8,ue)):ee("",!0)])]))),128)):(d(),f("tr",ce,e[19]||(e[19]=[t("td",{colspan:"9",class:"text-center"},"No records found.",-1)])))])])]),i(a,{sm:"12",lg:"12",class:"mt-5 d-flex justify-content-end mb-n5"},{default:p(()=>[t("nav",de,[t("ul",pe,[t("li",{class:T(["page-item",{disabled:u.value===1}])},[t("button",{class:"page-link",onClick:e[7]||(e[7]=o=>k(u.value-1)),disabled:u.value===1},"Previous",8,me)],2),(d(!0),f(x,null,A(b.value,o=>(d(),f("li",{key:o,class:T(["page-item",{active:u.value===o}])},[t("button",{class:"page-link",onClick:j=>k(o)},m(o),9,ve)],2))),128)),t("li",{class:T(["page-item",{disabled:u.value===b.value}])},[t("button",{class:"page-link",onClick:e[8]||(e[8]=o=>k(u.value+1)),disabled:u.value===b.value},"Next",8,fe)],2)])])]),_:1})]),_:1})]),_:1})}}};export{ye as _};
