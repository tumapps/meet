import{_ as $,j as _,o as i,c as d,F as A,C as E,G as I,b as l,t as y,A as V,z as k,r as N,d as D,w as R,m as j,v as z,n as B,H as w,S as T}from"./index.a8b7f511.js";const G={class:"timeslots-container justify-content-start"},O=["onClick"],H={class:"timeslot-content"},Q={class:"timeslot-time"},J={class:"timeslot-time"},K={__name:"TimeSlotComponent",props:{timeSlots:{type:Array,required:!0}},emits:["update:timeSlots","selectedSlotsTimes"],setup(S,{emit:x}){const v=S,b=x,n=_([]),u=t=>{const c=v.timeSlots[t];if(c.booked)return;if(c.selected)c.selected=!1,n.value=n.value.filter(m=>m!==t);else if(n.value.length===0)c.selected=!0,n.value.push(t);else{const m=n.value[n.value.length-1];t<m?(v.timeSlots.forEach(p=>p.selected=!1),n.value=[],c.selected=!0,n.value.push(t)):t===m+1?(c.selected=!0,n.value.push(t)):(v.timeSlots.forEach(p=>p.selected=!1),n.value=[],c.selected=!0,n.value.push(t))}b("update:timeSlots",v.timeSlots);const r=n.value.map(m=>({startTime:v.timeSlots[m].startTime,endTime:v.timeSlots[m].endTime}));let f="",h="";r.length>0&&(f=r[0].startTime,h=r[r.length-1].endTime),b("selectedSlotsTimes",{startTime:f,endTime:h})};return(t,c)=>(i(),d("div",G,[(i(!0),d(A,null,E(S.timeSlots,(r,f)=>(i(),d("div",{key:r.startTime,class:I(["timeslot",{booked:r.booked,selected:r.selected,expired:r.is_expired}]),onClick:h=>u(f)},[l("div",H,[l("div",Q,y(r.startTime),1),c[0]||(c[0]=l("p",{class:"timeslot-separator"},"to",-1)),l("div",J,y(r.endTime),1)])],10,O))),128))]))}};var re=$(K,[["__scopeId","data-v-05c6b1cd"]]);const W={class:"search-form"},X={key:0,class:"list-group position-relative",role:"listbox"},Y=["onClick"],Z={key:1,class:"text-muted mt-2"},ee={key:0,class:"table-responsive"},te={class:"table table-striped table-bordered"},se={key:1,class:"text-muted fw-bold small"},ae=["onClick"],oe=["onClick"],le={__name:"AttendeesComponent",props:{attendees:{type:Array,default:()=>[]},meetingId:{type:Number,required:!0},submitSignal:{type:String,required:!0}},emits:["newAttendee"],setup(S,{emit:x}){const v=x,b=S,n=_(null),u=_([]),t=_([]),c=_(null),r=_({attendees:{}}),f=V();k(()=>b.attendees,e=>{t.value=e.map(a=>{var o;return{...a,id:(o=a.attendee_id)!=null?o:a.id,fromBackend:!0,removed:!1}})},{immediate:!0});const h=_(null);k(()=>b.meetingId,e=>{h.value=e},{immediate:!0}),k(n,e=>{if(!e){u.value=[];return}m()});const m=async()=>{var a;const e=n.value.trim().toLowerCase();try{const o=await f.get("/v1/auth/users");if((a=o.data)!=null&&a.dataPayload){const g=o.data.dataPayload.data;u.value=g.filter(s=>s.username.toLowerCase().includes(e)&&!t.value.some(C=>C.id===s.id))}}catch(o){console.error("Error fetching users:",o)}},p=_([]);k(p,e=>{v("newAttendee",e)});const P=e=>{t.value.some(o=>o.attendee_id===e.id)?T.fire("Error!","Attendee already added.","error"):(t.value.push({...e,fromBackend:!1,removed:!1}),p.value=t.value.map(o=>o.id),u.value=""),n.value="",u.value=[]},L=(e,a)=>{a?(c.value=e,q()):(t.value.splice(e,1),p.value=t.value.map(o=>o.id))},q=()=>{T.fire({title:"Provide a reason for Removal",input:"textarea",inputLabel:"Removal Reason",inputPlaceholder:"Please type your reason here...",inputAttributes:{"aria-label":"Please type your reason here"},showCancelButton:!0,confirmButtonText:"Confirm",cancelButtonText:"Cancel",confirmButtonColor:"primary",cancelButtonColor:"#d33",preConfirm:e=>e||(T.showValidationMessage("Reason is required!"),!1)}).then(e=>{if(e.isConfirmed){const a=e.value,o=t.value[c.value];t.value.splice(c.value,1),p.value=t.value.map(g=>g.id),o.removed=!0,r.value.attendees[o.attendee_id]=a,M()}})},F=e=>{const a=t.value[e];a.removed=!1,r.value.attendees=r.value.attendees.filter(o=>o.staff_id!==a.staff_id)},M=async()=>{var e;if(Object.keys(r.value.attendees).length===0){console.warn("No attendees to remove");return}try{(e=(await f.put(`/v1/scheduler/remove-attendee/${h.value}`,r.value)).data)!=null&&e.dataPayload&&T.fire("Success!","Removed attendees have been submitted successfully.","success")}catch(a){console.error("Error submitting removed attendees:",a)}};return(e,a)=>{const o=N("b-form-group"),g=N("b-col");return i(),d("div",null,[D(g,{cols:"12"},{default:R(()=>[l("div",W,[D(o,{label:"Attendees:","label-for":"input-1"},{default:R(()=>[j(l("input",{"onUpdate:modelValue":a[0]||(a[0]=s=>n.value=s),type:"text",class:"form-control mb-2",placeholder:"Search using username...","aria-label":"Search for a username"},null,512),[[z,n.value]])]),_:1}),u.value.length>0?(i(),d("ul",X,[(i(!0),d(A,null,E(u.value,s=>(i(),d("li",{key:s.id,class:"list-group-item list-group-item-action",onClick:C=>P(s)},y(s.username),9,Y))),128))])):n.value&&!u.value.length?(i(),d("p",Z,"No results found.")):B("",!0)])]),_:1}),t.value.length>0?(i(),d("div",ee,[l("table",te,[a[1]||(a[1]=l("thead",null,[l("tr",null,[l("th",null,"Names"),l("th",null,"Email"),l("th",null,"Status"),l("th",null,"Action")])],-1)),l("tbody",null,[(i(!0),d(A,null,E(t.value,(s,C)=>(i(),d("tr",{key:s.staff_id,class:I(["custom-row",{"text-muted":s.removed}])},[l("td",null,[l("span",{style:w({textDecoration:s.removed?"line-through":"none"})},y(s.fullname),5)]),l("td",null,[l("span",{style:w({textDecoration:s.removed?"line-through":"none"})},y(s.email),5)]),l("td",null,[["PENDING","CONFIRMED","DECLINED"].includes(s.status)?(i(),d("span",{key:0,class:I([s.status==="PENDING"?"bg-info text-white":s.status==="CONFIRMED"?"bg-success text-white":s.status==="DECLINED"?"bg-danger text-white":"","fw-bold text-nowrap px-2 py-1 small rounded"]),style:w({textDecoration:s.removed?"line-through":"none"})},y(s.status),7)):(i(),d("span",se,"not delivered"))]),l("td",null,[s.removed?(i(),d("i",{key:1,class:"fas fa-undo text-success cursor-pointer",onClick:U=>F(C),title:"Restore"},null,8,oe)):(i(),d("i",{key:0,class:"fas fa-trash-alt text-danger cursor-pointer",onClick:U=>L(C,s.fromBackend),title:"Remove"},null,8,ae))])],2))),128))])])])):B("",!0)])}}};var ie=$(le,[["__scopeId","data-v-55070015"]]);export{ie as A,re as T};
