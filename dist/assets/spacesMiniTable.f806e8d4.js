import{j as r,A as G,y as Q,z as H,q as W,r as g,o as d,g as X,w as p,d as i,b as t,m as Y,c as f,F as T,C as x,t as v,D as Z,e as y,n as ee,G as A,p as te}from"./index.f2403e4a.js";const oe={class:"d-flex justify-content-between"},se={class:"d-flex align-items-center"},ae=["value"],ne={class:"d-flex align-items-center"},re={class:"table-responsive"},le={class:"table table-hover"},ie=["onClick"],ue=["onClick"],ce={key:1},de={"aria-label":"Page navigation"},pe={class:"pagination justify-content-end"},ve=["disabled"],me=["onClick"],fe=["disabled"],Ce={__name:"spacesMiniTable",setup(ge){const m=r(""),{proxy:l}=te(),h=G(),P=r([]),_=r(""),E=r("asc"),N=r(!1),u=r(1),b=r(1),V=r(20),w=r(20),D=r([20,50]),C=r(""),$=r({}),M=async()=>{await c(w.value)},k=a=>{a>0&&a<=b.value&&(u.value=a,c(a))},R=async()=>{await c(1)},S=Q(()=>[...P.value].sort((a,e)=>{let s=E.value==="asc"?1:-1;return a[_.value]<e[_.value]?-1*s:a[_.value]>e[_.value]?1*s:0})),c=async a=>{try{const e={page:a,"per-page":w.value};C.value&&(e._search=C.value);const s=await h.get("/v1/scheduler/pending-appointments",{params:e});P.value=s.data.dataPayload.data,u.value=s.data.current_page,b.value=s.data.last_page,V.value=s.data.per_page,N.value=Array.isArray(s.data.data)}catch(e){if(console.error(e),e.response&&e.response.data&&e.response.data.errorPayload)$.value=e.response.data.errorPayload.errors;else{const s=e.message||"An unknown error occurred";l.$showToast({title:"An error occurred",text:s,icon:"error"})}}};H(C,()=>{c(1)});const I=async a=>{var e;try{const s=await h.put(`v1/scheduler/approve/${a}`);c(1),s.data.toastPayload?(m.value=s.data.toastPayload,l.$showAlert({title:m.value.toastTheme,icon:m.value.toastTheme,text:m.value.toastMessage,showCancelButton:!1,showConfirmButton:!1,timer:4e3,timerProgressBar:!0})):l.$showToast({title:"operation successful",icon:"success"}),c(1)}catch(s){const n=(e=s.response.data.errorPayload.errors)==null?void 0:e.message;l.$showToast({title:"An error occurred",text:n,icon:"error"})}},O=async a=>{l.$showAlert({title:"APPROVE",text:"Do you want to proceed?",icon:"warning",showCancelButton:!0,confirmButtonText:"Proceed",cancelButtonText:"Cancel",confirmButtonColor:"#076232",cancelButtonColor:"#d33"}).then(e=>{e.isConfirmed&&I(a)})},q=async(a,e)=>{var s;try{const n=await h.put(`v1/scheduler/reject/${a}`,{rejection_reason:e});n.data.toastPayload?(m.value=n.data.toastPayload,l.$showAlert({title:m.value.toastTheme,icon:m.value.toastTheme,text:m.value.toastMessage,showCancelButton:!1,showConfirmButton:!1,timer:4e3,timerProgressBar:!0})):l.$showToast({title:"operation successful",icon:"success"}),c(1)}catch(n){if(n.response&&n.response.data.errorPayload)$.value=n.response.data.errorPayload.errors;else{const B=(s=n.response.data.errorPayload.errors)==null?void 0:s.message;l.$showToast({title:"An error occurred",text:B,icon:"error"})}}},F=a=>{l.$showAlert({title:"REJECT",text:"By rejecting to grant permission the meeting will be CANCELLED. Do you want to proceed?",icon:"warning",showCancelButton:!0,confirmButtonText:"Proceed",cancelButtonText:"Cancel",confirmButtonColor:"#076232",cancelButtonColor:"#d33"}).then(e=>{if(e.isConfirmed){const s=()=>{l.$showAlert({title:"REJECT",text:"Please provide a reason for rejecting the request",input:"text",inputPlaceholder:"reason",inputAttributes:{maxlength:100},showCancelButton:!0,confirmButtonText:"Reject",cancelButtonText:"Cancel",confirmButtonColor:"#076232",cancelButtonColor:"#d33"}).then(n=>{n.isConfirmed&&(!n.value||n.value.trim()===""?l.$showAlert({title:"Invalid Input",text:"Reason cannot be empty. Please provide a valid reason.",icon:"error",confirmButtonText:"OK",confirmButtonColor:"#d33",showCancelButton:!1}).then(()=>{s()}):(q(a,n.value.trim()),c(1)))})};s()}})};return W(()=>{c(1)}),(a,e)=>{const s=g("b-col"),n=g("b-form-input"),B=g("b-button"),J=g("b-input-group-append"),L=g("b-input-group"),z=g("b-row"),K=g("b-card");return d(),X(s,{lg:"12"},{default:p(()=>[i(K,null,{default:p(()=>[i(s,{lg:"6"},{default:p(()=>e[9]||(e[9]=[t("div",null,[t("h2",null,"Space Requests")],-1)])),_:1}),i(z,{class:"mb-3"},{default:p(()=>[i(s,{lg:"12",class:"mb-3"}),i(s,{lg:"12"},{default:p(()=>[t("div",oe,[t("div",se,[Y(t("select",{id:"itemsPerPage","onUpdate:modelValue":e[0]||(e[0]=o=>w.value=o),onChange:M,class:"form-select form-select-sm"},[(d(!0),f(T,null,x(D.value,o=>(d(),f("option",{key:o,value:o},v(o),9,ae))),128))],544),[[Z,w.value]])]),t("div",ne,[i(L,null,{default:p(()=>[i(n,{placeholder:"Search...",modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=o=>C.value=o)},null,8,["modelValue"]),i(J,null,{default:p(()=>[i(B,{variant:"primary",onClick:R},{default:p(()=>e[10]||(e[10]=[y("Search")])),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1}),t("div",re,[t("table",le,[t("thead",null,[t("tr",null,[e[15]||(e[15]=t("th",null,"Space",-1)),t("th",{onClick:e[2]||(e[2]=o=>a.sortTable("appointment_date"))},"Date"),t("th",{onClick:e[3]||(e[3]=o=>a.sortTable("start_time"))},e[11]||(e[11]=[y("Time "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[4]||(e[4]=o=>a.sortTable("subject"))},e[12]||(e[12]=[y("Subject "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[5]||(e[5]=o=>a.sortTable("userName"))},e[13]||(e[13]=[y("ChairPerson "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[6]||(e[6]=o=>a.sortTable("contact_name"))},e[14]||(e[14]=[y("Contact Name "),t("i",{class:"fas fa-sort"},null,-1)])),e[16]||(e[16]=t("th",null,"Actions",-1))])]),t("tbody",null,[Array.isArray(P.value)&&P.value.length>0?(d(!0),f(T,{key:0},x(S.value,(o,j)=>(d(),f("tr",{key:j},[t("td",null,v(o.space.name),1),t("td",null,v(o.appointment_date),1),t("td",null,v(o.start_time)+"- "+v(o.end_time),1),t("td",null,v(o.subject),1),t("td",null,v(o.userName),1),t("td",null,v(o.contact_name),1),t("td",null,[t("button",{class:"btn btn-outline-primary btn-sm me-3",onClick:U=>O(o.id)},e[17]||(e[17]=[t("i",{class:"fas fa-check",title:"APPROVE"},null,-1)]),8,ie),o.is_deleted!=="1"?(d(),f("button",{key:0,class:"btn btn-outline-danger btn-sm me-3",onClick:U=>F(o.id)},e[18]||(e[18]=[t("i",{class:"fas fa-ban",title:"REJECT"},null,-1)]),8,ue)):ee("",!0)])]))),128)):(d(),f("tr",ce,e[19]||(e[19]=[t("td",{colspan:"9",class:"text-center"},"No records found.",-1)])))])])]),i(s,{sm:"12",lg:"12",class:"mt-5 d-flex justify-content-end mb-n5"},{default:p(()=>[t("nav",de,[t("ul",pe,[t("li",{class:A(["page-item",{disabled:u.value===1}])},[t("button",{class:"page-link",onClick:e[7]||(e[7]=o=>k(u.value-1)),disabled:u.value===1},"Previous",8,ve)],2),(d(!0),f(T,null,x(b.value,o=>(d(),f("li",{key:o,class:A(["page-item",{active:u.value===o}])},[t("button",{class:"page-link",onClick:j=>k(o)},v(o),9,me)],2))),128)),t("li",{class:A(["page-item",{disabled:u.value===b.value}])},[t("button",{class:"page-link",onClick:e[8]||(e[8]=o=>k(u.value+1)),disabled:u.value===b.value},"Next",8,fe)],2)])])]),_:1})]),_:1})]),_:1})}}};export{Ce as _};
