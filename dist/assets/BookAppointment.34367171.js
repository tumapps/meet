import{_ as X,h as m,o as i,c as u,F as U,y as V,z as Z,b as o,t as p,i as ee,A as te,q as O,s as oe,r as z,f as R,w as n,d as s,k,v as A,l as f,I as E,x as F,j as se,m as le}from"./index.2be4e476.js";import{C as ae}from"./component.126ff93d.js";const ne={class:"timeslots-container justify-content-center"},re=["onClick"],ie={class:"d-flex flex-column justify-content-center align-items-center h-100"},de={class:"px-3 py-2 text-center w-100"},ue={class:"px-3 py-2 text-center w-100"},me={__name:"TimeSlotComponent",props:{timeSlots:{type:Array,required:!0}},emits:["update:timeSlots","selectedSlotsTimes"],setup(P,{emit:w}){const _=P,h=w,c=m([]),T=l=>{const b=_.timeSlots[l];if(b.booked)return;if(b.selected)b.selected=!1,c.value=c.value.filter(g=>g!==l);else if(c.value.length===0)b.selected=!0,c.value.push(l);else{const g=c.value[c.value.length-1];l<g?(_.timeSlots.forEach(x=>x.selected=!1),c.value=[],b.selected=!0,c.value.push(l)):l===g+1?(b.selected=!0,c.value.push(l)):(_.timeSlots.forEach(x=>x.selected=!1),c.value=[],b.selected=!0,c.value.push(l))}h("update:timeSlots",_.timeSlots);const v=c.value.map(g=>({startTime:_.timeSlots[g].startTime,endTime:_.timeSlots[g].endTime}));let y="",C="";v.length>0&&(y=v[0].startTime,C=v[v.length-1].endTime),h("selectedSlotsTimes",{startTime:y,endTime:C})};return(l,b)=>(i(),u("div",ne,[(i(!0),u(U,null,V(P.timeSlots,(v,y)=>(i(),u("div",{key:v.startTime,class:Z(["timeslot",{booked:v.booked,selected:v.selected}]),onClick:C=>T(y)},[o("div",ie,[o("div",de,p(v.startTime),1),o("div",ue,p(v.endTime),1)])],10,re))),128))]))}};var ce=X(me,[["__scopeId","data-v-90fce9da"]]);const pe={id:"add-form",action:"javascript:void(0)",method:"post"},ve={class:"d-flex flex-column align-items-start"},_e={class:"w-100",id:"v-pills-tabContent"},be={class:"fade active show m-5",id:"-3"},fe={key:0,class:"error","aria-live":"polite"},ye={key:0,class:"error","aria-live":"polite"},ge={key:0,class:"error","aria-live":"polite"},he={for:"addappointmenttype",class:"col-form-label"},Se=["value"],ke={key:0,class:"error","aria-live":"polite"},xe=["value"],Te={key:0,class:"error","aria-live":"polite"},we={key:0,class:"error","aria-live":"polite"},Ce={key:0,class:"error","aria-live":"polite"},Ae={for:"addappointmenttype",class:"col-form-label"},Ue=["value"],Ve={key:0,class:"error","aria-live":"polite"},Pe={for:"addappointmenttype",class:"col-form-label"},je={key:0,class:"error","aria-live":"polite"},$e={class:"modal-footer border-0"},Ie={__name:"BookAppointment",props:{selectedDate:String},setup(P){const w=ee(),_=te(),{proxy:h}=le(),c=m("");c.value=w.getCanBeBooked();const T=m(""),l=m({contact_name:"",email_address:"",start_time:"",mobile_number:"",subject:"",appointment_type:"",description:""}),b=m([]),v=m([]),y=m(null),C={dateFormat:"Y-m-d",altInput:!0,altFormat:"F j, Y",minDate:"today"},g=m(new Date().toLocaleDateString()),x=m(null),j=m(null);T.value=w.getUserId();const $=m({user_id:T,date:""}),d=m({user_id:T,appointment_date:y.value,start_time:"",end_time:"",contact_name:"",email_address:"",mobile_number:"",subject:"",description:"",appointment_type:"",priority:""}),q=(t,e)=>{d.value.appointment_date=t,$.value.date=t,W()};O(y,(t,e)=>{q(t)});const L=t=>{b.value=t},Y=t=>{d.value.start_time=(t==null?void 0:t.startTime)||"",d.value.end_time=(t==null?void 0:t.endTime)||""},W=async()=>{try{const t=await _.post("/v1/scheduler/get-slots",$.value);v.value=t.data.dataPayload.data.slots;const e=v.value.map(r=>({...r,selected:!1}));b.value=e}catch{h.$showToast({title:"An error occurred ",text:"Ooops! an error has occured ",icon:"error"})}},G=async()=>{l.value={};try{const t=await _.post("/v1/scheduler/appointments",d.value);h.$showAlert({title:"Success",text:"Appointment booked successfully",icon:"success"}),d.value={}}catch(t){t.response&&t.response.status===422&&t.response.data.errorPayload&&(l.value=t.response.data.errorPayload.errors)}},N=m([]),M=async()=>{try{const t=await _.get("/v1/scheduler/types");N.value=t.data.dataPayload.data.types}catch{h.$showToast({title:"An error occurred ",text:"Ooops! an error has occured",icon:"error"})}},B=m([]),D=m([]),I=m(""),H=async()=>{try{const t=await _.get("/v1/auth/users");B.value=t.data.dataPayload.data.profiles}catch{h.$showToast({title:"An error occurred",text:"Oops! An error has occurred",icon:"error"})}},J=async()=>{try{const t=await _.get("/v1/scheduler/priorities");D.value=t.data.dataPayload.data}catch{h.$showToast({title:"An error occurred",text:"Oops! An error has occurred",icon:"error"})}};O(I,t=>{const e=B.value.find(r=>r.first_name===t);x.value=e?e.user_id:null,T.value=x.value?x.value:w.getUserId()}),O(j,t=>{const e=D.value.find(r=>r.code===t);d.value.priority=e?e.code:null});const K=()=>{};return oe(()=>{$.value.date=g.value,M(),M(),H(),J()}),(t,e)=>{const r=z("b-col"),S=z("b-row"),Q=z("b-modal");return i(),R(Q,{ref:"appointmentModal",title:"Book Appointment",class:"modal-fullscreen my-modal rounded-modal","no-close-on-backdrop":"","no-close-on-esc":"",size:"xl","hide-footer":""},{default:n(()=>[o("form",pe,[o("div",ve,[e[19]||(e[19]=o("input",{type:"hidden",name:"id"},null,-1)),e[20]||(e[20]=o("input",{type:"hidden",name:"appointment_type"},null,-1)),o("div",_e,[o("div",be,[s(S,{class:"align-items-center form-group"},{default:n(()=>[s(r,{cols:"2"},{default:n(()=>e[10]||(e[10]=[o("label",{for:"addcontactname",class:"col-form-label"},"Name",-1)])),_:1}),s(r,{cols:"10"},{default:n(()=>[k(o("input",{type:"text",id:"addcontactname","onUpdate:modelValue":e[0]||(e[0]=a=>d.value.contact_name=a),class:"form-control"},null,512),[[A,d.value.contact_name]]),l.value.contact_name?(i(),u("div",fe,p(l.value.contact_name),1)):f("",!0)]),_:1})]),_:1}),s(S,{class:"align-items-center form-group"},{default:n(()=>[s(r,{cols:"2",class:"mb-sm-3 mb-md-3 mb-lg-0"},{default:n(()=>e[11]||(e[11]=[o("label",{for:"addphonenumber",class:"col-form-label"},"Phone",-1)])),_:1}),s(r,{cols:"10",lg:"4",class:"mb-sm-3 mb-md-3 mb-lg-0"},{default:n(()=>[k(o("input",{type:"text",id:"addphonenumber","onUpdate:modelValue":e[1]||(e[1]=a=>d.value.mobile_number=a),class:"form-control"},null,512),[[A,d.value.mobile_number]]),l.value.mobile_number?(i(),u("div",ye,p(l.value.mobile_number),1)):f("",!0)]),_:1}),s(r,{cols:"2",lg:"1"},{default:n(()=>e[12]||(e[12]=[o("label",{for:"addemail",class:"col-form-label"},"Email",-1)])),_:1}),s(r,{cols:"10",lg:"5"},{default:n(()=>[k(o("input",{type:"text",id:"addemail","onUpdate:modelValue":e[2]||(e[2]=a=>d.value.email_address=a),class:"form-control"},null,512),[[A,d.value.email_address]]),l.value.email_address?(i(),u("div",ge,p(l.value.email_address),1)):f("",!0)]),_:1})]),_:1}),c.value===0?(i(),R(S,{key:0,class:"align-items-center form-group"},{default:n(()=>[s(r,{cols:"2",class:"mb-sm-3 mb-md-3 mb-lg-0"},{default:n(()=>[o("label",he,[s(E,{type:"outlined","icon-name":"user",size:24})])]),_:1}),s(r,{cols:"10",lg:"4",class:"mb-sm-3 mb-md-3 mb-lg-0"},{default:n(()=>[k(o("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>I.value=a),name:"service",class:"form-select",id:"addappointmenttype"},[e[13]||(e[13]=o("option",{value:""},"Recipient",-1)),(i(!0),u(U,null,V(B.value,a=>(i(),u("option",{key:a.user_id,value:a.first_name},p(a.first_name),9,Se))),128))],512),[[F,I.value]]),l.value.user_id?(i(),u("div",ke,p(l.value.user_id),1)):f("",!0)]),_:1})]),_:1})):f("",!0),s(S,{class:"align-items-center form-group"},{default:n(()=>[s(r,{cols:"2",class:"mb-sm-3 mb-md-3 mb-lg-0"},{default:n(()=>e[14]||(e[14]=[o("label",{for:"addappointmenttype",class:"col-form-label"}," Priority ",-1)])),_:1}),s(r,{cols:"10",lg:"4",class:"mb-sm-3 mb-md-3 mb-lg-0"},{default:n(()=>[k(o("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>j.value=a),name:"priority",class:"form-select",id:"addappointmenttype"},[e[15]||(e[15]=o("option",{value:""},"Select Priority",-1)),(i(!0),u(U,null,V(D.value,a=>(i(),u("option",{key:a.code,value:a.code},p(a.label),9,xe))),128))],512),[[F,j.value]]),l.value.priority?(i(),u("div",Te,p(l.value.priority),1)):f("",!0)]),_:1}),s(r,{cols:"2",lg:"1",class:"mb-sm-3 mb-md-3 mb-lg-0"},{default:n(()=>e[16]||(e[16]=[o("label",{for:"addsubject",class:"col-form-label"},"RE:",-1)])),_:1}),s(r,{cols:"10",lg:"4",class:"mb-sm-3 mb-md-3 mb-lg-0"},{default:n(()=>[k(o("input",{type:"text",id:"addsubject","onUpdate:modelValue":e[5]||(e[5]=a=>d.value.subject=a),class:"form-control",placeholder:"what the meeting is about"},null,512),[[A,d.value.subject]]),l.value.subject?(i(),u("div",we,p(l.value.subject),1)):f("",!0)]),_:1})]),_:1}),s(S,{class:"g-3 align-items-center form-group"},{default:n(()=>[s(r,{cols:"2"},{default:n(()=>e[17]||(e[17]=[o("label",{for:"addphonenumber",class:"col-form-label"},"Notes",-1)])),_:1}),s(r,{cols:"10"},{default:n(()=>[k(o("input",{type:"text",id:"addphonenumber","onUpdate:modelValue":e[6]||(e[6]=a=>d.value.description=a),class:"form-control"},null,512),[[A,d.value.description]]),l.value.description?(i(),u("div",Ce,p(l.value.description),1)):f("",!0)]),_:1})]),_:1}),s(S,{class:"align-items-center form-group"},{default:n(()=>[s(r,{cols:"2",class:"mb-sm-3 mb-md-3 mb-lg-0"},{default:n(()=>[o("label",Ae,[s(E,{type:"outlined","icon-name":"pencil",size:24})])]),_:1}),s(r,{cols:"10",lg:"4",class:"mb-sm-3 mb-md-3 mb-lg-0"},{default:n(()=>[k(o("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>d.value.appointment_type=a),name:"service",class:"form-select",id:"addappointmenttype"},[e[18]||(e[18]=o("option",{value:""},"Appointment Type",-1)),(i(!0),u(U,null,V(N.value,a=>(i(),u("option",{key:a,value:a},p(a),9,Ue))),128))],512),[[F,d.value.appointment_type]]),l.value.appointment_type?(i(),u("div",Ve,p(l.value.appointment_type),1)):f("",!0)]),_:1}),s(r,{cols:"2",lg:"1",class:"mb-sm-3 mb-md-3 mb-lg-0"},{default:n(()=>[o("label",Pe,[s(E,{type:"outlined","icon-name":"calendar",size:24})])]),_:1}),s(r,{cols:"10",lg:"5",class:"mb-sm-3 mb-md-3 mb-lg-0"},{default:n(()=>[s(se(ae),{modelValue:y.value,"onUpdate:modelValue":e[8]||(e[8]=a=>y.value=a),class:"form-control",config:C,id:"datePicker"},null,8,["modelValue"])]),_:1})]),_:1}),s(S,{class:"g-3 align-items-center form-group mt-3 mb-5 p-2"},{default:n(()=>[s(S,null,{default:n(()=>[s(r,{md:"12",lg:"12",sm:"12"},{default:n(()=>[s(ce,{timeSlots:b.value,"onUpdate:timeSlots":L,onSelectedSlotsTimes:Y},null,8,["timeSlots"])]),_:1})]),_:1}),l.value.start_time?(i(),u("div",je,p(l.value.start_time),1)):f("",!0)]),_:1})])])])]),o("div",$e,[o("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onClick:e[9]||(e[9]=a=>K())},"Discard Changes"),o("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",name:"save",onClick:G},"Save")])]),_:1},512)}}};export{ce as T,Ie as _};
