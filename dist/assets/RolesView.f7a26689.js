import{A as te,j as n,z as le,y as oe,q as ae,r as y,o as i,c,d as o,w as a,b as t,e as P,m as se,D as re,F as $,C as T,G as M,t as p,n as A,p as ne}from"./index.848ef5b1.js";import{_ as de}from"./RolePermissions.47840038.js";import"./pdfjs.7adb8c57.js";const ue={class:"d-flex justify-content-end"},ie={class:"d-flex justify-content-between"},ce={class:"d-flex align-items-center"},me=["value"],ve={class:"d-flex align-items-center"},pe={class:"table-responsive"},fe={class:"table table-hover"},ye=["onClick"],_e=["onClick"],be={key:1},ge={"aria-label":"Page navigation"},we={class:"pagination justify-content-end"},ke=["disabled"],he=["onClick"],Pe=["disabled"],xe={class:"mb-3"},Ce={key:0,class:"error","aria-live":"polite"},Re={class:"mb-3"},Ve={key:0,class:"error","aria-live":"polite"},$e={class:"mb-3"},Ae={key:0,class:"error","aria-live":"polite"},Ne={class:"mb-3"},De={key:0,class:"error","aria-live":"polite"},Te={class:"d-flex justify-content-end"},Se={__name:"RolesView",setup(Me){const x=te(),{proxy:f}=ne(),U=n("asc"),C=n(""),b=n(""),v=n(1),R=n(1),N=n(20),I=n([20,50]),V=n(null),B={name:"",description:"",type:"1",data:"",ruleName:""},m=n({...B}),O=()=>{m.value={...B.value}},w=n([]),u=n({}),z=()=>{u.value={}},k=n(null),F=()=>{z(),O()},q=()=>{V.value&&V.value.show()},D=s=>{s>0&&s<=R.value&&(v.value=s,_(s))},G=async()=>{var s;k.value=null;try{const e=await x.post("v1/auth/role",m.value);e.data.toastPayload?(k.value=e.data.toastPayload,V.value.hide(),_(),f.$showAlert({title:k.value.toastTheme,icon:k.value.toastTheme,text:k.value.toastMessage,timer:4e3,showConfirmButton:!1,showCancelButton:!1})):f.$showToast({title:"Appointment Deleted successfully",icon:"success"})}catch(e){u.value=e.response.data.errorPayload.errors;const r=((s=e.response.data.errorPayload.errors)==null?void 0:s.message)||e.response.errorPayload.message||"An unknown error occurred";f.$showToast({title:"An error occurred",text:r,icon:"error"})}},_=async(s=v.value)=>{try{const e=await x.get(`/v1/auth/roles?page=${s}&per-page=${N.value}&_search=${b.value}`);w.value=Object.values(e.data.dataPayload.data)}catch(e){console.error(e)}};le(b,()=>{b.value===""?_():Q()});const j=n(null),E=n(""),H=s=>{E.value=s,j.value.$refs.roleModal.show()},K=oe(()=>[...w.value].sort((s,e)=>{let r=U.value==="asc"?1:-1;return s[C.value]<e[C.value]?-1*r:s[C.value]>e[C.value]?1*r:0})),L=async()=>{await _(1)},Q=async()=>{var s;try{const e=await x.get(`v1/auth/manage-role?_search=${b.value}`);w.value=Object.values(e.data.dataPayload.data)}catch(e){u.value=e.response.data.errorPayload.errors;const r=((s=e.response.data.errorPayload.errors)==null?void 0:s.message)||e.response.errorPayload.message||"An unknown error occurred";f.$showToast({title:"An error occurred",text:r,icon:"error"})}},Y=async s=>{var r;if((await f.$showAlert({title:"Delete Role",text:"Are you sure you want to delete this role?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete",cancelButtonText:"No, cancel"})).isConfirmed)try{const d=await x.delete(`v1/auth/role/${s}`);d.data.toastPayload?(f.$showAlert({title:d.data.toastPayload.toastTheme,icon:d.data.toastPayload.toastTheme,text:d.data.toastPayload.toastMessage,timer:4e3,showConfirmButton:!1,showCancelButton:!1}),_()):f.$showToast({title:"Role Deleted successfully",icon:"success"})}catch(d){u.value=d.response.data.errorPayload.errors;const g=((r=d.response.data.errorPayload.errors)==null?void 0:r.message)||d.response.errorPayload.message||"An unknown error occurred";f.$showToast({title:"An error occurred",text:g,icon:"error"})}};return ae(()=>{_()}),(s,e)=>{const r=y("b-col"),d=y("b-button"),g=y("b-row"),h=y("b-form-input"),J=y("b-input-group-append"),W=y("b-input-group"),X=y("b-card"),Z=y("b-modal");return i(),c($,null,[o(r,{lg:"12"},{default:a(()=>[o(X,null,{default:a(()=>[o(g,{class:"mb-5"},{default:a(()=>[o(r,{lg:"6"},{default:a(()=>e[10]||(e[10]=[t("div",null,[t("h2",null,"Roles")],-1)])),_:1}),o(r,{lg:"6"},{default:a(()=>[t("div",ue,[o(d,{variant:"primary",onClick:q},{default:a(()=>e[11]||(e[11]=[P(" New Role ")])),_:1})])]),_:1})]),_:1}),o(g,{class:"mb-3"},{default:a(()=>[o(r,{lg:"12"},{default:a(()=>[t("div",ie,[t("div",ce,[se(t("select",{id:"itemsPerPage","onUpdate:modelValue":e[0]||(e[0]=l=>N.value=l),onChange:L,class:"form-select form-select-sm"},[(i(!0),c($,null,T(I.value,l=>(i(),c("option",{key:l,value:l},p(l),9,me))),128))],544),[[re,N.value]])]),t("div",ve,[o(W,null,{default:a(()=>[o(h,{placeholder:"Search...",modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=l=>b.value=l)},null,8,["modelValue"]),o(J,null,{default:a(()=>[o(d,{variant:"primary",onClick:e[2]||(e[2]=l=>_(1))},{default:a(()=>e[12]||(e[12]=[P("Search")])),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1}),t("div",pe,[t("table",fe,[t("thead",null,[t("tr",null,[t("th",{onClick:e[3]||(e[3]=l=>s.sortTable("start_date"))},e[13]||(e[13]=[P("Role Name "),t("i",{class:"fas fa-sort"},null,-1)])),e[14]||(e[14]=t("th",null,"Description",-1)),e[15]||(e[15]=t("th",null,"Data",-1)),e[16]||(e[16]=t("th",null,"Actions",-1))])]),t("tbody",null,[Array.isArray(w.value)&&w.value.length>0?(i(!0),c($,{key:0},T(K.value,(l,S)=>(i(),c("tr",{key:S},[t("td",null,p(l.name),1),t("td",null,p(l.description),1),t("td",null,p(l.data),1),t("td",null,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm me-3",onClick:ee=>H(l.name)},e[17]||(e[17]=[t("i",{class:"fa-solid fa-shield",style:{color:"#076232"}},null,-1)]),8,ye),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:ee=>Y(l.name)},e[18]||(e[18]=[t("i",{class:"fa-solid fa-trash"},null,-1)]),8,_e)])]))),128)):(i(),c("tr",be,e[19]||(e[19]=[t("td",{colspan:"6",class:"text-center"},"No records found.",-1)])))])])]),o(r,{sm:"12",lg:"12",class:"mt-5 d-flex justify-content-end mb-n5"},{default:a(()=>[t("nav",ge,[t("ul",we,[t("li",{class:M(["page-item",{disabled:v.value===1}])},[t("button",{class:"page-link",onClick:e[4]||(e[4]=l=>D(v.value-1)),disabled:v.value===1},"Previous",8,ke)],2),(i(!0),c($,null,T(R.value,l=>(i(),c("li",{key:l,class:M(["page-item",{active:v.value===l}])},[t("button",{class:"page-link",onClick:S=>D(l)},p(l),9,he)],2))),128)),t("li",{class:M(["page-item",{disabled:v.value===R.value}])},[t("button",{class:"page-link",onClick:e[5]||(e[5]=l=>D(v.value+1)),disabled:v.value===R.value},"Next",8,Pe)],2)])])]),_:1})]),_:1})]),_:1}),o(Z,{ref_key:"AddRole",ref:V,title:"Add Role",class:"my-modal taller-modal modal-fullscreen","no-close-on-esc":"",size:"xl","hide-footer":"",centered:"","hide-header-close":"false",onHide:F},{"modal-header":a(({close:l})=>[e[21]||(e[21]=t("h5",{class:"modal-title"},"Add Role",-1)),o(d,{variant:"light",onClick:l,class:"close"},{default:a(()=>e[20]||(e[20]=[P(" \xD7 ")])),_:2},1032,["onClick"])]),default:a(()=>[o(g,null,{default:a(()=>[o(r,{md:"12",lg:"6"},{default:a(()=>[t("div",xe,[e[22]||(e[22]=t("label",{for:"startDatePicker",class:"form-label"},"Role Name",-1)),o(h,{modelValue:m.value.name,"onUpdate:modelValue":e[6]||(e[6]=l=>m.value.name=l),id:"startDatePicker",type:"text",placeholder:"Enter Role Name"},null,8,["modelValue"])]),u.value.name?(i(),c("div",Ce,p(u.value.name),1)):A("",!0)]),_:1}),o(r,{md:"12",lg:"6"},{default:a(()=>[t("div",Re,[e[23]||(e[23]=t("label",{for:"startDatePicker",class:"form-label"},"Role Data",-1)),o(h,{modelValue:m.value.data,"onUpdate:modelValue":e[7]||(e[7]=l=>m.value.data=l),id:"roledata",type:"text",placeholder:"Enter Role data"},null,8,["modelValue"])]),u.value.data?(i(),c("div",Ve,p(u.value.data),1)):A("",!0)]),_:1})]),_:1}),o(g,null,{default:a(()=>[o(r,{md:"12",lg:"6"},{default:a(()=>[t("div",$e,[e[24]||(e[24]=t("label",{for:"roledescription",class:"form-label"},"Description",-1)),o(h,{modelValue:m.value.description,"onUpdate:modelValue":e[8]||(e[8]=l=>m.value.description=l),id:"roledescription",type:"text",placeholder:"Enter description"},null,8,["modelValue"])]),u.value.description?(i(),c("div",Ae,p(u.value.description),1)):A("",!0)]),_:1}),o(r,{md:"12",lg:"6"},{default:a(()=>[t("div",Ne,[e[25]||(e[25]=t("label",{for:"rolerulename",class:"form-label"},"Rule name",-1)),o(h,{modelValue:m.value.ruleName,"onUpdate:modelValue":e[9]||(e[9]=l=>m.value.ruleName=l),id:"rolerulename",type:"text",placeholder:"Enter Role data"},null,8,["modelValue"])]),u.value.ruleName?(i(),c("div",De,p(u.value.ruleName),1)):A("",!0)]),_:1})]),_:1}),t("div",Te,[o(d,{onClick:G,variant:"primary"},{default:a(()=>e[26]||(e[26]=[P("Save")])),_:1})])]),_:1},512),o(de,{ref_key:"roleModal",ref:j,roleName:E.value},null,8,["roleName"])],64)}}};export{Se as default};
