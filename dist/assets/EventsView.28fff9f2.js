import{_ as Y,j as i,A as Z,y as ee,z as te,q as se,r as p,o,c as r,d as u,w as d,b as s,e as y,m as ne,D as ae,F as h,C as N,G as D,t as b,n as x,p as le}from"./index.a8b7f511.js";import{_ as oe}from"./AddEvent.1e666c48.js";import{_ as re}from"./viewEvent.bc1bb1bf.js";import"./pdfjs.7adb8c57.js";import"./component.1096433d.js";const ue={class:"d-flex justify-content-end"},ie={class:"d-flex justify-content-between"},de={class:"d-flex align-items-center"},ce=["value"],ve={class:"d-flex align-items-center"},fe={class:"table-responsive"},be={class:"table table-hover"},pe=["onClick","disabled"],me=["onClick"],_e=["onClick","disabled"],Ce={key:3,class:"btn btn-outline-warning btn-sm me-3",disabled:""},ye=["onClick","disabled"],ge={key:5,class:"btn btn-outline-danger btn-sm me-3",disabled:""},Ee=["onClick"],ke={key:1},we={"aria-label":"Page navigation"},Pe={class:"pagination justify-content-end"},he=["disabled"],De=["onClick"],xe=["disabled"],$e={__name:"EventsView",setup(Te){const m=i(""),{proxy:c}=le(),$=Z(),g=i([]),_=i(""),E=i("asc"),f=i(1),C=i(1),R=i(20),T=i(20),F=i([20,50]),k=i(""),O=i(""),B=i(null),A=i(null),z=a=>{A.value&&A.value.showModal(a)},S=a=>{a>0&&a<=C.value&&(f.value=a,v(a))},G=async()=>{f.value=1,await v(1)},L=a=>{_.value===a?E.value=E.value==="asc"?"desc":"asc":(_.value=a,E.value="asc")},K=ee(()=>[...g.value].sort((a,e)=>{let n=E.value==="asc"?1:-1;return a[_.value]<e[_.value]?-1*n:a[_.value]>e[_.value]?1*n:0})),M=i(null),V=a=>{B.value&&(M.value=a,B.value.show())},v=async a=>{var e;try{const n=await $.get(`v1/scheduler/events?page=${a}&perPage=${T.value}&_search=${k.value}`);g.value=n.data.dataPayload.data,f.value=n.data.dataPayload.currentPage,C.value=n.data.dataPayload.totalPages,R.value=n.data.dataPayload.perPage}catch(n){const l=((e=n.response.data.errorPayload.errors)==null?void 0:e.message)||"An error occurred";c.$showToast({title:l,icon:"error"})}};te(k,()=>{v(1)});const j=(a,e)=>{c.$showAlert({title:"Are you sure?",text:" Do you want to "+e+" this Event ?",icon:"warning",showCancelButton:!0,confirmButtonText:e,cancelButtonText:"Cancel",confirmButtonColor:"#076232",cancelButtonColor:"#d33"}).then(n=>{n.isConfirmed&&U(a)})},U=async a=>{var e;try{const n=await $.delete(`v1/scheduler/events/${a}`);v(1),n.data.toastPayload?(m.value=n.data.toastPayload,c.$showToast({title:m.value.toastMessage||"Deleted successfully",icon:"success"})):c.$showToast({title:"success",icon:"success"})}catch(n){const l=(e=n.response.data.errorPayload.errors)==null?void 0:e.message;c.$showToast({title:l,text:l,icon:"error"})}},q=async(a,e)=>{var n;try{const l=await $.put(`v1/scheduler/cancel/${a}`,{cancellation_reason:e});l.data.toastPayload?(m.value=l.data.toastPayload,c.$showAlert({title:m.value.toastTheme,icon:m.value.toastTheme,text:m.value.toastMessage,showCancelButton:!1,showConfirmButton:!1,timer:4e3,timerProgressBar:!0})):c.$showToast({title:"operation successful",icon:"success"}),v(1)}catch(l){if(l.response&&l.response.data.errorPayload)O.value=l.response.data.errorPayload.errors;else{const w=(n=l.response.data.errorPayload.errors)==null?void 0:n.message;c.$showToast({title:"An error occurred",text:w,icon:"error"})}}},Q=a=>{c.$showAlert({title:"Cancel Event",text:"Do you want to Cancel this Event ?",icon:"warning",showCancelButton:!0,confirmButtonText:"Proceed",cancelButtonText:"Cancel",confirmButtonColor:"#076232",cancelButtonColor:"#d33"}).then(e=>{if(e.isConfirmed){const n=()=>{c.$showAlert({title:"Event Cancellation",text:"Please provide a reason for cancelling this Event.",input:"text",inputPlaceholder:"reason",inputAttributes:{maxlength:100},showCancelButton:!0,confirmButtonText:"Submit",cancelButtonText:"Cancel",confirmButtonColor:"#076232",cancelButtonColor:"#d33"}).then(l=>{l.isConfirmed&&(!l.value||l.value.trim()===""?c.$showAlert({title:"Invalid Input",text:"Reason cannot be empty. Please provide a valid reason.",icon:"error",confirmButtonText:"OK",confirmButtonColor:"#d33",showCancelButton:!1}).then(()=>{n()}):(q(a,l.value.trim()),v(1)))})};n()}})};return se(async()=>{v(1)}),(a,e)=>{const n=p("b-col"),l=p("b-button"),w=p("b-row"),H=p("b-form-input"),J=p("b-input-group-append"),W=p("b-input-group"),X=p("b-card");return o(),r(h,null,[u(n,{lg:"12"},{default:d(()=>[u(X,null,{default:d(()=>[u(w,{class:"mb-5"},{default:d(()=>[u(n,{lg:"6"},{default:d(()=>e[9]||(e[9]=[s("div",null,[s("h2",null,"Events")],-1)])),_:1}),u(n,{lg:"6"},{default:d(()=>[s("div",ue,[u(l,{variant:"primary",onClick:z},{default:d(()=>e[10]||(e[10]=[y(" Add Event ")])),_:1})])]),_:1})]),_:1}),u(w,{class:"mb-3"},{default:d(()=>[u(n,{lg:"12",md:"12",sm:"12"},{default:d(()=>[s("div",ie,[s("div",de,[ne(s("select",{id:"itemsPerPage","onUpdate:modelValue":e[0]||(e[0]=t=>T.value=t),onChange:G,class:"form-select form-select-sm",style:{width:"auto"}},[(o(!0),r(h,null,N(F.value,t=>(o(),r("option",{key:t,value:t},b(t),9,ce))),128))],544),[[ae,T.value]])]),s("div",ve,[u(W,null,{default:d(()=>[u(H,{placeholder:"Search...","aria-label":"Search",modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=t=>k.value=t)},null,8,["modelValue"]),u(J,null,{default:d(()=>[u(l,{variant:"primary",onChange:e[2]||(e[2]=t=>v(1)),onClick:e[3]||(e[3]=t=>v(1))},{default:d(()=>e[11]||(e[11]=[y(" Search ")])),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1}),s("div",fe,[s("table",be,[s("thead",null,[s("tr",null,[s("th",{onClick:e[4]||(e[4]=t=>L("title"))},e[12]||(e[12]=[y(" Title "),s("i",{class:"fas fa-sort"},null,-1)])),e[15]||(e[15]=s("th",null,"Description",-1)),s("th",{onClick:e[5]||(e[5]=t=>L("appointment_date"))},e[13]||(e[13]=[y(" Date "),s("i",{class:"fas fa-sort"},null,-1)])),s("th",{onClick:e[6]||(e[6]=t=>L("start_time"))},e[14]||(e[14]=[y(" Time "),s("i",{class:"fas fa-sort"},null,-1)])),e[16]||(e[16]=s("th",null,"Status",-1)),e[17]||(e[17]=s("th",null,"Actions",-1))])]),s("tbody",null,[Array.isArray(g.value)&&g.value.length>0?(o(!0),r(h,{key:0},N(K.value,(t,I)=>(o(),r("tr",{key:I},[s("td",null,b(t.title),1),s("td",null,b(t.description),1),s("td",null,b(t.start_date)+" - "+b(t.end_date),1),s("td",null,b(t.start_time)+" - "+b(t.end_time),1),s("td",null,[s("span",{class:D("badge bg-"+t.recordStatus.theme)},b(t.recordStatus.label),3)]),s("td",null,[t.recordStatus.label!=="DELETED"&&t.recordStatus.label!=="CANCELLED"?(o(),r("button",{key:0,class:"btn btn-outline-primary btn-sm me-3",onClick:P=>V(t.id),disabled:t.checked_in},e[18]||(e[18]=[s("i",{class:"fas fa-edit",title:"Edit"},null,-1)]),8,pe)):t.recordStatus.label==="DELETED"||t.recordStatus.label==="CANCELLED"?(o(),r("button",{key:1,class:"btn btn-outline-primary btn-sm me-3",onClick:P=>V(t.id)},e[19]||(e[19]=[s("i",{class:"fas fa-eye",title:"View"},null,-1)]),8,me)):x("",!0),t.recordStatus.label!=="DELETED"&&t.recordStatus.label!=="CANCELLED"?(o(),r("button",{key:2,class:"btn btn-outline-warning btn-sm me-3",onClick:P=>Q(t.id,"Cancel"),disabled:t.checked_in},e[20]||(e[20]=[s("i",{class:"fas fa-cancel",title:"Cancel"},null,-1)]),8,_e)):t.recordStatus.label==="DELETED"||t.recordStatus.label==="CANCELLED"?(o(),r("button",Ce,e[21]||(e[21]=[s("i",{class:"fas fa-cancel",title:"Cancel (Disabled)"},null,-1)]))):x("",!0),t.recordStatus.label!=="DELETED"&&t.recordStatus.label!=="CANCELLED"?(o(),r("button",{key:4,class:"btn btn-outline-danger btn-sm me-3",onClick:P=>j(t.id,"Delete"),disabled:t.checked_in},e[22]||(e[22]=[s("i",{class:"fas fa-trash",title:"Delete"},null,-1)]),8,ye)):t.recordStatus.label==="CANCELLED"?(o(),r("button",ge,e[23]||(e[23]=[s("i",{class:"fas fa-trash",title:"Delete (Disabled)"},null,-1)]))):x("",!0),t.recordStatus.label==="DELETED"?(o(),r("button",{key:6,class:"btn btn-outline-danger btn-sm",onClick:P=>j(t.id,"Restore")},e[24]||(e[24]=[s("i",{class:"fas fa-undo",title:"Restore"},null,-1)]),8,Ee)):x("",!0)])]))),128)):(o(),r("tr",ke,e[25]||(e[25]=[s("td",{colspan:"6",class:"text-center"},"No records found.",-1)])))])])]),u(n,{sm:"12",lg:"12",md:"12",class:"d-flex justify-content-end mt-5 mb-n5"},{default:d(()=>[s("nav",we,[s("ul",Pe,[s("li",{class:D(["page-item",{disabled:f.value===1}])},[s("button",{class:"page-link",onClick:e[7]||(e[7]=t=>S(f.value-1)),disabled:f.value===1},"Previous",8,he)],2),(o(!0),r(h,null,N(C.value,t=>(o(),r("li",{key:t,class:D(["page-item",{active:f.value===t}])},[s("button",{class:"page-link",onClick:I=>S(t)},b(t),9,De)],2))),128)),s("li",{class:D(["page-item",{disabled:f.value===C.value}])},[s("button",{class:"page-link",onClick:e[8]||(e[8]=t=>S(f.value+1)),disabled:f.value===C.value},"Next",8,xe)],2)])])]),_:1})]),_:1})]),_:1}),u(oe,{ref_key:"eventModalRef",ref:A,onNewEvent:v},null,512),u(re,{ref_key:"editevent",ref:B,onGetEvents:v,event_id:M.value},null,8,["event_id"])],64)}}};var Me=Y($e,[["__scopeId","data-v-142886e4"]]);export{Me as default};
