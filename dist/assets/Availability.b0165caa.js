import{_ as ue,i as ce,h as u,A as ve,s as me,C as fe,r as _,o as n,c as d,d as s,w as o,b as t,e as b,k as pe,x as _e,F as E,y as I,z as O,j as y,t as c,l as p,m as be}from"./index.2be4e476.js";import{C as g}from"./component.126ff93d.js";const ye={class:"d-flex justify-content-end"},ge={class:"d-flex justify-content-between"},ke={class:"d-flex align-items-center"},Pe=["value"],Ae={class:"d-flex align-items-center"},Ve={class:"table-responsive"},we={class:"table table-hover"},Te=["onClick"],Ce=["onClick"],xe={key:1},$e={"aria-label":"Page navigation"},De={class:"pagination justify-content-end"},Se=["disabled"],Ue=["onClick"],Ee=["disabled"],Fe={class:"mb-3"},he={key:0,class:"error","aria-live":"polite"},Be={class:"mb-3"},Ne={key:0,class:"error","aria-live":"polite"},je={class:"mb-3"},Me={key:0,class:"error","aria-live":"polite"},Ie={class:"mb-3"},Oe={key:0,class:"error","aria-live":"polite"},Le={key:0,class:"error","aria-live":"polite"},ze={class:"d-flex justify-content-end"},Ye={class:"mb-3"},He={key:0,class:"error","aria-live":"polite"},Ke={class:"mb-3"},Qe={key:0,class:"error","aria-live":"polite"},qe={class:"mb-3"},Ge={key:0,class:"error","aria-live":"polite"},Je={class:"mb-3"},Re={key:0,class:"error","aria-live":"polite"},We={key:0,class:"error","aria-live":"polite"},Xe={class:"d-flex justify-content-end"},Ze={__name:"Availability",setup(et){const Q=ce(),F=u(null),h=u(null),P=u({}),L=u("");L.value=Q.getUserId();const r=u({user_id:L.value,start_date:"",end_date:"",start_time:"",end_time:"",description:""}),$={enableTime:!1,dateFormat:"Y-m-d"},D={enableTime:!0,noCalendar:!0,dateFormat:"H:i",time_24hr:!0,minuteIncrement:10},q=()=>{F.value&&F.value.show()},G=l=>{h.value&&(ae(l),h.value.show())},{proxy:m}=be(),A=ve(),w=u([]),V=u(""),S=u("asc"),z=u(!1),f=u(1),T=u(1),J=u(20),B=u(20),R=u([10,20,50,100]),N=u(""),W=u(""),i=u({}),j=l=>{l>0&&l<=T.value&&(f.value=l,getAppointments(l))},X=async()=>{f.value=1,await getAppointments(1)},C=l=>{V.value===l?S.value=S.value==="asc"?"desc":"asc":(V.value=l,S.value="asc")},Z=async()=>{try{const l=await A.get(`v1/scheduler/availabilities?search=${N.value}`);z.value=Array.isArray(l.data),w.value=l.data.dataPayload.data}catch{m.$showToast({title:"An error occurred ",text:"Ooops! an error occured",icon:"error"})}};me(async()=>{U(1)});const ee=l=>{W.value=l,m.$showAlert({title:"Are you sure?",text:"You are about to DELETE this entry. Do you want to proceed?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, DELETE it!",cancelButtonText:"No, keep it",confirmButtonColor:"#d33",cancelButtonColor:"#097B3E"}).then(e=>{e.isConfirmed&&(te(l),U(1))})},te=async l=>{try{const e=await A.delete(`v1/scheduler/availability/${l}`);e.data.toastPayload?(P.value=e.data.toastPayload,m.$showToast({title:P.value.toastMessage||"operation successful",icon:"success"})):m.$showToast({title:"operation successful",icon:"success"}),U(1)}catch{m.$showToast({title:"An error occurred ",text:"Ooops! an error occured",icon:"error"})}},U=async(l=1)=>{try{const e=await A.get(`v1/scheduler/availabilities?page=${l}&perPage=${B.value}`);z.value=Array.isArray(e.data),w.value=e.data.dataPayload.data,f.value=e.data.dataPayload.currentPage,T.value=e.data.dataPayload.totalPages,J.value=e.data.dataPayload.perPage}catch{m.$showToast({title:"An error occurred ",text:"Ooops! an error occured",icon:"error"})}},ae=async l=>{try{const e=await A.get(`v1/scheduler/availability/${l}`);r.value=e.data.dataPayload.data}catch{m.$showToast({title:"An error occurred ",text:"Ooops! an error occured",icon:"error"})}},le=fe(()=>[...w.value].sort((l,e)=>{let k=S.value==="asc"?1:-1;return l[V.value]<e[V.value]?-1*k:l[V.value]>e[V.value]?1*k:0})),se=async()=>{try{const l=await A.post("v1/scheduler/availability",r.value);l.data.toastPayload?(P.value=l.data.toastPayload,m.$showToast({title:P.value.toastMessage||"created successfully",icon:"success"})):m.$showToast({title:"Created successfully",icon:"success"}),U(1)}catch(l){l.response&&l.response.data&&l.response.data.errorPayload?i.value=l.response.data.errorPayload.errors:m.$showToast({title:"Failed",text:"An error occurred",icon:"error"})}},oe=async()=>{try{const l=await A.put(`v1/scheduler/availability/${id}`,r.value);l.data.toastPayload?(P.value=l.data.toastPayload,m.$showToast({title:P.value.toastMessage||"Updated successfully",icon:"success"})):m.$showToast({title:"Updated successfully",icon:"success"})}catch(l){l.response&&l.response.data&&l.response.data.errorPayload?i.value=l.response.data.errorPayload.errors:m.$showToast({title:"Failed",text:"Failed to update your settings.",icon:"error"})}};return(l,e)=>{const k=_("b-button"),v=_("b-col"),M=_("b-form-input"),re=_("b-input-group-append"),ie=_("b-input-group"),x=_("b-row"),ne=_("b-card"),Y=_("b-form-group"),H=_("b-modal");return n(),d(E,null,[s(v,{lg:"12"},{default:o(()=>[s(ne,null,{default:o(()=>[e[30]||(e[30]=t("div",null,[t("h2",null,"Availability")],-1)),s(x,{class:"mb-3"},{default:o(()=>[s(v,{lg:"12",class:"mb-3"},{default:o(()=>[t("div",ye,[s(k,{variant:"primary",onClick:q},{default:o(()=>e[19]||(e[19]=[b(" New Availability ")])),_:1})])]),_:1}),s(v,{lg:"12"},{default:o(()=>[t("div",ge,[t("div",ke,[pe(t("select",{id:"itemsPerPage","onUpdate:modelValue":e[0]||(e[0]=a=>B.value=a),onChange:X,class:"form-select form-select-sm"},[(n(!0),d(E,null,I(R.value,a=>(n(),d("option",{key:a,value:a},c(a),9,Pe))),128))],544),[[_e,B.value]])]),t("div",Ae,[s(ie,null,{default:o(()=>[s(M,{placeholder:"Search...",modelValue:N.value,"onUpdate:modelValue":e[1]||(e[1]=a=>N.value=a)},null,8,["modelValue"]),s(re,null,{default:o(()=>[s(k,{variant:"primary",onClick:Z},{default:o(()=>e[20]||(e[20]=[b("Search")])),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1}),t("div",Ve,[t("table",we,[t("thead",null,[t("tr",null,[t("th",{onClick:e[2]||(e[2]=a=>C("description"))},e[21]||(e[21]=[b("Description "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[3]||(e[3]=a=>C("start_date"))},e[22]||(e[22]=[b("Start Date "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[4]||(e[4]=a=>C("end_date"))},e[23]||(e[23]=[b("End Date "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[5]||(e[5]=a=>C("start_time"))},e[24]||(e[24]=[b("Start Time "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[6]||(e[6]=a=>C("end_time"))},e[25]||(e[25]=[b("End Time "),t("i",{class:"fas fa-sort"},null,-1)])),e[26]||(e[26]=t("th",null,"Actions",-1))])]),t("tbody",null,[Array.isArray(w.value)&&w.value.length>0?(n(!0),d(E,{key:0},I(le.value,(a,K)=>(n(),d("tr",{key:K},[t("td",null,c(a.description),1),t("td",null,c(a.start_date),1),t("td",null,c(a.end_date),1),t("td",null,c(a.start_time),1),t("td",null,c(a.end_time),1),t("td",null,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm me-3",onClick:de=>G(a.id)},e[27]||(e[27]=[t("i",{class:"fas fa-edit",title:"edit entry"},null,-1)]),8,Te),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:de=>ee(a.id)},e[28]||(e[28]=[t("i",{class:"fas fa-trash",title:"delete entry"},null,-1)]),8,Ce)])]))),128)):(n(),d("tr",xe,e[29]||(e[29]=[t("td",{colspan:"6",class:"text-center"},"No records found.",-1)])))])])]),s(v,{sm:"12",lg:"12",class:"mt-5 d-flex justify-content-end mb-n5"},{default:o(()=>[t("nav",$e,[t("ul",De,[t("li",{class:O(["page-item",{disabled:f.value===1}])},[t("button",{class:"page-link",onClick:e[7]||(e[7]=a=>j(f.value-1)),disabled:f.value===1},"Previous",8,Se)],2),(n(!0),d(E,null,I(T.value,a=>(n(),d("li",{key:a,class:O(["page-item",{active:f.value===a}])},[t("button",{class:"page-link",onClick:K=>j(a)},c(a),9,Ue)],2))),128)),t("li",{class:O(["page-item",{disabled:f.value===T.value}])},[t("button",{class:"page-link",onClick:e[8]||(e[8]=a=>j(f.value+1)),disabled:f.value===T.value},"Next",8,Ee)],2)])])]),_:1})]),_:1})]),_:1}),s(H,{ref_key:"newAvailability",ref:F,title:"New Availability",class:"modal-fullscreen my-modal","no-close-on-backdrop":"","no-close-on-esc":"",size:"xl","hide-footer":""},{default:o(()=>[e[36]||(e[36]=t("h4",null,"Availability Settings",-1)),s(x,null,{default:o(()=>[s(v,{md:"12"},{default:o(()=>[t("div",Fe,[e[31]||(e[31]=t("label",{for:"startDatePicker",class:"form-label"},"Start Date",-1)),s(y(g),{modelValue:r.value.start_date,"onUpdate:modelValue":e[9]||(e[9]=a=>r.value.start_date=a),class:"form-control",config:$,id:"startDatePicker"},null,8,["modelValue"])]),i.value.start_date?(n(),d("div",he,c(i.value.start_date),1)):p("",!0)]),_:1}),s(v,{md:"12"},{default:o(()=>[t("div",Be,[e[32]||(e[32]=t("label",{for:"endDatePicker",class:"form-label"},"Last Date",-1)),s(y(g),{modelValue:r.value.end_date,"onUpdate:modelValue":e[10]||(e[10]=a=>r.value.end_date=a),class:"form-control",config:$,id:"endDatePicker"},null,8,["modelValue"])]),i.value.end_date?(n(),d("div",Ne,c(i.value.end_date),1)):p("",!0)]),_:1})]),_:1}),s(x,null,{default:o(()=>[s(v,{md:"6"},{default:o(()=>[t("div",je,[e[33]||(e[33]=t("label",{for:"startTimePicker",class:"form-label"},"Start Time",-1)),s(y(g),{modelValue:r.value.start_time,"onUpdate:modelValue":e[11]||(e[11]=a=>r.value.start_time=a),class:"form-control",config:D,id:"startTimePicker"},null,8,["modelValue"])]),i.value.start_time?(n(),d("div",Me,c(i.value.start_time),1)):p("",!0)]),_:1}),s(v,{md:"5"},{default:o(()=>[t("div",Ie,[e[34]||(e[34]=t("label",{for:"endTimePicker",class:"form-label"},"End Time",-1)),s(y(g),{modelValue:r.value.end_time,"onUpdate:modelValue":e[12]||(e[12]=a=>r.value.end_time=a),class:"form-control",config:D,id:"endTimePicker"},null,8,["modelValue"])]),i.value.end_time?(n(),d("div",Oe,c(i.value.end_time),1)):p("",!0)]),_:1}),s(v,{md:"12",class:"mb-3"},{default:o(()=>[s(Y,{label:"Description","label-for":"descriptionField"},{default:o(()=>[s(M,{id:"descriptionField",type:"text",modelValue:r.value.description,"onUpdate:modelValue":e[13]||(e[13]=a=>r.value.description=a)},null,8,["modelValue"]),i.value.description?(n(),d("div",Le,c(i.value.description),1)):p("",!0)]),_:1})]),_:1})]),_:1}),t("div",ze,[s(k,{onClick:se,variant:"primary"},{default:o(()=>e[35]||(e[35]=[b("Save")])),_:1})])]),_:1},512),s(H,{ref_key:"updateAvailability",ref:h,title:"update Availability",class:"modal-fullscreen my-modal","no-close-on-backdrop":"","no-close-on-esc":"",size:"xl","hide-footer":""},{default:o(()=>[e[42]||(e[42]=t("h4",null,"Availability Settings",-1)),s(x,null,{default:o(()=>[s(v,{md:"12"},{default:o(()=>[t("div",Ye,[e[37]||(e[37]=t("label",{for:"startDatePicker",class:"form-label"},"Start Date",-1)),s(y(g),{modelValue:r.value.start_date,"onUpdate:modelValue":e[14]||(e[14]=a=>r.value.start_date=a),class:"form-control",config:$,id:"startDatePicker"},null,8,["modelValue"])]),i.value.start_date?(n(),d("div",He,c(i.value.start_date),1)):p("",!0)]),_:1}),s(v,{md:"12"},{default:o(()=>[t("div",Ke,[e[38]||(e[38]=t("label",{for:"endDatePicker",class:"form-label"},"Last Date",-1)),s(y(g),{modelValue:r.value.end_date,"onUpdate:modelValue":e[15]||(e[15]=a=>r.value.end_date=a),class:"form-control",config:$,id:"endDatePicker"},null,8,["modelValue"])]),i.value.end_date?(n(),d("div",Qe,c(i.value.end_date),1)):p("",!0)]),_:1})]),_:1}),s(x,null,{default:o(()=>[s(v,{md:"6"},{default:o(()=>[t("div",qe,[e[39]||(e[39]=t("label",{for:"startTimePicker",class:"form-label"},"Start Time",-1)),s(y(g),{modelValue:r.value.start_time,"onUpdate:modelValue":e[16]||(e[16]=a=>r.value.start_time=a),class:"form-control",config:D,id:"startTimePicker"},null,8,["modelValue"])]),i.value.start_time?(n(),d("div",Ge,c(i.value.start_time),1)):p("",!0)]),_:1}),s(v,{md:"5"},{default:o(()=>[t("div",Je,[e[40]||(e[40]=t("label",{for:"endTimePicker",class:"form-label"},"End Time",-1)),s(y(g),{modelValue:r.value.end_time,"onUpdate:modelValue":e[17]||(e[17]=a=>r.value.end_time=a),class:"form-control",config:D,id:"endTimePicker"},null,8,["modelValue"])]),i.value.end_time?(n(),d("div",Re,c(i.value.end_time),1)):p("",!0)]),_:1}),s(v,{md:"12",class:"mb-3"},{default:o(()=>[s(Y,{label:"Description","label-for":"descriptionField"},{default:o(()=>[s(M,{id:"descriptionField",type:"text",modelValue:r.value.description,"onUpdate:modelValue":e[18]||(e[18]=a=>r.value.description=a)},null,8,["modelValue"]),i.value.description?(n(),d("div",We,c(i.value.description),1)):p("",!0)]),_:1})]),_:1})]),_:1}),t("div",Xe,[s(k,{onClick:oe,variant:"primary"},{default:o(()=>e[41]||(e[41]=[b("Update")])),_:1})])]),_:1},512)],64)}}};var lt=ue(Ze,[["__scopeId","data-v-ddb8549e"]]);export{lt as default};
