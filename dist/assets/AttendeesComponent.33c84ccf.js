import{_ as j,j as g,y as D,o as c,c as u,b as s,F as R,C as E,G as B,t as b,n as N,A as J,z as M,r as q,B as K,d as z,w as H,m as P,v as W,H as F,S as L}from"./index.16224396.js";const X={class:"timeslots-container"},Y={key:0,class:"time-group"},Z={class:"group-slots"},ee=["onClick"],te={class:"timeslot-content"},se={class:"timeslot-time"},oe={key:1,class:"time-group"},le={class:"group-slots"},ne=["onClick"],ae={class:"timeslot-content"},re={class:"timeslot-time"},ie={key:2,class:"time-group"},de={class:"group-slots"},ce=["onClick"],ue={class:"timeslot-content"},me={class:"timeslot-time"},ve={__name:"TimeSlotComponent",props:{timeSlots:{type:Array,required:!0}},emits:["update:timeSlots","selectedSlotsTimes"],setup(V,{emit:U}){const p=V,T=U,d=g([]),v=D(()=>p.timeSlots.map((r,o)=>({...r,originalIndex:o}))),i=D(()=>v.value.filter(r=>{const o=parseInt(r.startTime.split(":")[0]);return o>=6&&o<12})),y=D(()=>v.value.filter(r=>{const o=parseInt(r.startTime.split(":")[0]);return o>=12&&o<17})),_=D(()=>v.value.filter(r=>{const o=parseInt(r.startTime.split(":")[0]);return o>=17||o<6})),x=r=>{const[o,e]=r.split(":"),f=parseInt(o),k=f>=12?"PM":"AM";return`${f%12||12}:${e} ${k}`},C=r=>{const o=p.timeSlots[r];if(console.log("slot selected:",o),console.log(p.timeSlots),o.booked)return;if(o.selected)o.selected=!1,d.value=d.value.filter(h=>h!==r);else if(d.value.length===0)o.selected=!0,d.value.push(r);else{const h=d.value[d.value.length-1];r<h?(p.timeSlots.forEach(A=>A.selected=!1),d.value=[],o.selected=!0,d.value.push(r)):r===h+1?(o.selected=!0,d.value.push(r)):(p.timeSlots.forEach(A=>A.selected=!1),d.value=[],o.selected=!0,d.value.push(r))}T("update:timeSlots",p.timeSlots);const e=d.value.map(h=>({startTime:p.timeSlots[h].startTime,endTime:p.timeSlots[h].endTime}));let f="",k="";e.length>0&&(f=e[0].startTime,k=e[e.length-1].endTime),T("selectedSlotsTimes",{startTime:f,endTime:k}),console.log(d.value)};return(r,o)=>(c(),u("div",X,[i.value.length?(c(),u("div",Y,[o[0]||(o[0]=s("h3",{class:"group-header"},"Morning",-1)),s("div",Z,[(c(!0),u(R,null,E(i.value,e=>(c(),u("div",{key:e.startTime,class:B(["timeslot",{booked:e.booked,selected:e.selected,expired:e.is_expired}]),onClick:f=>C(e.originalIndex)},[s("div",te,[s("div",se,b(x(e.startTime)),1)])],10,ee))),128))])])):N("",!0),y.value.length?(c(),u("div",oe,[o[1]||(o[1]=s("h3",{class:"group-header"},"Afternoon",-1)),s("div",le,[(c(!0),u(R,null,E(y.value,e=>(c(),u("div",{key:e.startTime,class:B(["timeslot",{booked:e.booked,selected:e.selected,expired:e.is_expired}]),onClick:f=>C(e.originalIndex)},[s("div",ae,[s("div",re,b(x(e.startTime)),1)])],10,ne))),128))])])):N("",!0),_.value.length?(c(),u("div",ie,[o[2]||(o[2]=s("h3",{class:"group-header"},"Evening",-1)),s("div",de,[(c(!0),u(R,null,E(_.value,e=>(c(),u("div",{key:e.startTime,class:B(["timeslot",{booked:e.booked,selected:e.selected,expired:e.is_expired}]),onClick:f=>C(e.originalIndex)},[s("div",ue,[s("div",me,b(x(e.startTime)),1)])],10,ce))),128))])])):N("",!0)]))}};var xe=j(ve,[["__scopeId","data-v-6c6f00d2"]]);const pe={class:"search-form"},_e={key:0,class:"list-group position-relative",role:"listbox"},fe=["onClick"],he={key:1,class:"text-muted mt-2"},ge={key:0,class:"table-responsive"},ye={class:"table table-striped table-bordered"},be=["onClick"],Ce=["onClick"],ke=["onClick"],Se={__name:"AttendeesComponent",props:{attendees:{type:Array,default:()=>[]},meetingId:{type:Number,required:!0},submitSignal:{type:String,required:!0}},emits:["newAttendee"],setup(V,{emit:U}){const p=U,T=V,d=g(null),v=g([]),i=g([]),y=g(null),_=g({attendees:{}}),x=["Attendee","Meeting Secretary"],C=J();M(()=>T.attendees,t=>{i.value=t.map(n=>{var l;return{...n,id:(l=n.attendee_id)!=null?l:n.id,fromBackend:!0,removed:!1}})},{immediate:!0});const r=g(null);M(()=>T.meetingId,t=>{r.value=t},{immediate:!0}),M(d,t=>{if(!t){v.value=[];return}o()});const o=async()=>{var n;const t=d.value.trim().toLowerCase();try{const l=await C.get("/v1/iam/users");if((n=l.data)!=null&&n.dataPayload){const m=l.data.dataPayload.data;v.value=m.filter(w=>{const I=w.username.toLowerCase().includes(t.toLowerCase())||w.fullname.toLowerCase().includes(t.toLowerCase()),a=!i.value.some($=>$.id===w.id);return I&&a})}}catch(l){console.error("Error fetching users:",l)}},e=g({attendees:[]});M(()=>e.value.attendees,t=>{console.log("watcher triggered",t),p("newAttendee",t)},{deep:!0});const f=t=>{i.value.some(l=>l.attendee_id===t.id)?L.fire("Error!","Attendee already added.","error"):(i.value.push({...t,fromBackend:!1,is_secretary:!1,role:"Attendee",removed:!1}),e.value.attendees=i.value.map(l=>({id:l.id,is_secretary:l.is_secretary})),v.value=""),console.log("final attendees",i.value),console.log("final attendeesId",e.value.attendees),d.value="",v.value=[]},k=(t,n)=>{n?(y.value=t,h()):(i.value.splice(t,1),e.value.attendees=i.value.map(l=>l.id),console.log("final attendees removed from table",i.value))},h=()=>{L.fire({title:"Provide a reason for Removal",input:"textarea",inputLabel:"Removal Reason",inputPlaceholder:"Please type your reason here...",inputAttributes:{"aria-label":"Please type your reason here"},showCancelButton:!0,confirmButtonText:"Confirm",cancelButtonText:"Cancel",confirmButtonColor:"primary",cancelButtonColor:"#d33",preConfirm:t=>t||(L.showValidationMessage("Reason is required!"),!1)}).then(t=>{if(t.isConfirmed){const n=t.value;console.log("Removal Reason:",i.value[y.value]);const l=i.value[y.value];i.value.splice(y.value,1),e.value.attendees=i.value.map(m=>m.id),l.removed=!0,_.value.attendees[l.attendee_id]=n,O(),console.log("Removed Attendees:",_.value),console.log("new attendeesids",e.value.attendees)}})},A=t=>{const n=i.value[t];n.removed=!1,_.value.attendees=_.value.attendees.filter(l=>l.staff_id!==n.staff_id)},G=(t,n)=>{const l=i.value.find(m=>m.id===t);!l||(n==="Meeting Secretary"?(i.value.forEach(m=>{m.id!==t&&m.is_secretary&&(m.is_secretary=!1,m.role="Attendee")}),l.is_secretary=!0,l.role=n):(l.is_secretary=!1,l.role=n),console.log("before:",e.value.attendees),e.value.attendees=i.value.map(m=>({id:m.id,is_secretary:m.is_secretary})),console.log("after:",e.value.attendees),console.log("to be ...",e.value))},O=async()=>{var t;if(Object.keys(_.value.attendees).length===0){console.warn("No attendees to remove");return}try{(t=(await C.put(`/v1/scheduler/remove-attendee/${r.value}`,_.value)).data)!=null&&t.dataPayload&&L.fire("Success!","Removed attendees have been submitted successfully.","success"),console.log("Removed Attendees:",_.value)}catch(n){console.log("meetingId:",r.value),console.error("Error submitting removed attendees:",n)}},Q=async()=>{console.log("my schedule")};return(t,n)=>{const l=q("b-form-group"),m=q("b-col"),w=q("b-form-select"),I=K("b-tooltip");return c(),u("div",null,[z(m,{cols:"12"},{default:H(()=>[s("div",pe,[z(l,{label:"Attendees:","label-for":"input-1"},{default:H(()=>[P(s("input",{"onUpdate:modelValue":n[0]||(n[0]=a=>d.value=a),type:"text",class:"form-control mb-2",placeholder:"Search using username...","aria-label":"Search for a username"},null,512),[[W,d.value]])]),_:1}),v.value.length>0?(c(),u("ul",_e,[(c(!0),u(R,null,E(v.value,a=>(c(),u("li",{key:a.id,class:"list-group-item list-group-item-action",onClick:$=>f(a)},b(a.fullname),9,fe))),128))])):d.value&&!v.value.length?(c(),u("p",he,"No results found.")):N("",!0)])]),_:1}),i.value.length>0?(c(),u("div",ge,[s("table",ye,[n[1]||(n[1]=s("thead",null,[s("tr",null,[s("th",null,"Names"),s("th",null,"Role"),s("th",null,"Email"),s("th",null,"Status"),s("th",null,"Action")])],-1)),s("tbody",null,[(c(!0),u(R,null,E(i.value,(a,$)=>(c(),u("tr",{key:a.staff_id,class:B(["custom-row",{"text-muted":a.removed}])},[s("td",null,[s("span",{style:F({textDecoration:a.removed?"line-through":"none"})},b(a.fullname),5)]),s("td",null,[z(w,{modelValue:a.role,"onUpdate:modelValue":S=>a.role=S,options:x,class:"mb-3",onChange:S=>G(a.id,S)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),s("td",null,[s("span",{style:F({textDecoration:a.removed?"line-through":"none"})},b(a.email),5)]),s("td",null,[s("span",{class:B([a.status==="PENDING"?"bg-info text-white":a.status==="CONFIRMED"?"bg-success text-white":a.status==="DECLINED"?"bg-danger text-white":"","fw-bold text-nowrap px-2 py-1 small rounded"]),style:F({textDecoration:a.removed?"line-through":"none"})},b(a.status),7)]),s("td",null,[a.removed?P((c(),u("i",{key:1,class:"fas fa-undo cursor-pointer",title:"Restore to list",onClick:S=>A($)},null,8,Ce)),[[I,void 0,void 0,{hover:!0}]]):P((c(),u("i",{key:0,class:"fas fa-trash-alt text-danger cursor-pointer",onClick:S=>k($,a.fromBackend),title:"Remove from list"},null,8,be)),[[I,void 0,void 0,{hover:!0}]]),P(s("i",{class:"fas fa-eye m-3",onClick:S=>Q(a.id),title:"View Schedule"},null,8,ke),[[I,void 0,void 0,{hover:!0}]])])],2))),128))])])])):N("",!0)])}}};var Ae=j(Se,[["__scopeId","data-v-383405cc"]]);export{Ae as A,xe as T};
