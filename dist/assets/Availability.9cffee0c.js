import{_ as re,h as c,A as de,p as ue,x as ce,r as _,o as r,c as d,b as t,d as a,w as s,e as b,k as ve,y as me,F as U,q as E,s as M,j as y,t as u,l as f,m as pe}from"./index.3cdb8f43.js";import{C as g}from"./component.30ce962e.js";const fe={class:"d-flex justify-content-end"},_e={class:"d-flex justify-content-between"},be={class:"d-flex align-items-center"},ye=["value"],ge={class:"d-flex align-items-center"},ke={class:"table-responsive"},Pe={class:"table table-hover"},Ae=["onClick"],Ve=["onClick"],we={key:1},xe={"aria-label":"Page navigation"},Ce={class:"pagination justify-content-end"},Te=["disabled"],$e=["onClick"],De=["disabled"],Se={class:"mb-3"},Ue={key:0,class:"error","aria-live":"polite"},Fe={class:"mb-3"},Ne={key:0,class:"error","aria-live":"polite"},Be={class:"mb-3"},je={key:0,class:"error","aria-live":"polite"},Ie={class:"mb-3"},Oe={key:0,class:"error","aria-live":"polite"},Ee={key:0,class:"error","aria-live":"polite"},Me={class:"d-flex justify-content-end"},ze={class:"mb-3"},Le={key:0,class:"error","aria-live":"polite"},Ye={class:"mb-3"},he={key:0,class:"error","aria-live":"polite"},qe={class:"mb-3"},He={key:0,class:"error","aria-live":"polite"},Ke={class:"mb-3"},Qe={key:0,class:"error","aria-live":"polite"},Ge={key:0,class:"error","aria-live":"polite"},Je={class:"d-flex justify-content-end"},Re={__name:"Availability",setup(We){const F=c(null),N=c(null),q=c(sessionStorage.getItem("user_id")),i=c({user_id:q.value,start_date:"",end_date:"",start_time:"",end_time:"",description:""}),T={enableTime:!1,dateFormat:"Y-m-d"},$={enableTime:!0,noCalendar:!0,dateFormat:"H:i",time_24hr:!0,minuteIncrement:10},H=()=>{F.value&&F.value.show()},K=o=>{N.value&&(ee(o),N.value.show())},{proxy:m}=pe(),P=de(),V=c([]),A=c(""),D=c("asc"),z=c(!1),p=c(1),w=c(1),Q=c(20),B=c(20),G=c([10,20,50,100]),j=c(""),J=c(""),n=c({}),I=o=>{o>0&&o<=w.value&&(p.value=o,getAppointments(o))},R=async()=>{p.value=1,await getAppointments(1)},x=o=>{A.value===o?D.value=D.value==="asc"?"desc":"asc":(A.value=o,D.value="asc")},W=async()=>{try{const o=await P.get(`v1/scheduler/availabilities?search=${j.value}`);z.value=Array.isArray(o.data),V.value=o.data.dataPayload.data}catch{m.$showToast({title:"An error occurred ",text:"Ooops! an error occured",icon:"error"})}};ue(async()=>{S(1)});const X=o=>{J.value=o,m.$showAlert({title:"Are you sure?",text:"You are about to cancel this entry. Do you want to proceed?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, cancel it!",cancelButtonText:"No, keep it",confirmButtonColor:"#d33",cancelButtonColor:"#3085d6"}).then(e=>{e.isConfirmed&&(Z(o),S(1))})},Z=async o=>{try{const e=await P.delete(`v1/scheduler/availability/${o}`);m.$showToast({title:"Appointment cancelled",icon:"success"}),S(1)}catch{m.$showToast({title:"An error occurred ",text:"Ooops! an error occured",icon:"error"})}},S=async(o=1)=>{try{const e=await P.get(`v1/scheduler/availabilities?page=${o}&perPage=${B.value}`);z.value=Array.isArray(e.data),V.value=e.data.dataPayload.data,p.value=e.data.dataPayload.currentPage,w.value=e.data.dataPayload.totalPages,Q.value=e.data.dataPayload.perPage}catch{m.$showToast({title:"An error occurred ",text:"Ooops! an error occured",icon:"error"})}},ee=async o=>{try{const e=await P.get(`v1/scheduler/availability/${o}`);i.value=e.data.dataPayload.data}catch{m.$showToast({title:"An error occurred ",text:"Ooops! an error occured",icon:"error"})}},te=ce(()=>[...V.value].sort((o,e)=>{let k=D.value==="asc"?1:-1;return o[A.value]<e[A.value]?-1*k:o[A.value]>e[A.value]?1*k:0})),le=async()=>{try{const o=await P.post("v1/scheduler/availability",i.value);m.$showToast({title:"Updated",text:"settings updated successfully!",icon:"success"}),S(1)}catch{m.$showToast({title:"Failed",text:"failed to update your settings",icon:"error"})}},ae=async()=>{try{const o=await P.put(`v1/scheduler/availability/${id}`,i.value);m.$showToast({title:"success",text:"updated successfully",icon:"success"})}catch{m.$showToast({title:"Failed",text:"failed to update your settings",icon:"error"})}};return(o,e)=>{const k=_("b-button"),v=_("b-col"),O=_("b-form-input"),oe=_("b-input-group-append"),se=_("b-input-group"),C=_("b-row"),ie=_("b-card"),L=_("b-form-group"),Y=_("b-modal");return r(),d(U,null,[e[43]||(e[43]=t("div",null,[t("h2",null,"Availability")],-1)),a(v,{lg:"12"},{default:s(()=>[a(ie,null,{default:s(()=>[a(C,{class:"mb-3"},{default:s(()=>[a(v,{lg:"12",class:"mb-3"},{default:s(()=>[t("div",fe,[a(k,{variant:"primary",onClick:H},{default:s(()=>e[19]||(e[19]=[b(" New Availability ")])),_:1})])]),_:1}),a(v,{lg:"12"},{default:s(()=>[t("div",_e,[t("div",be,[e[20]||(e[20]=t("label",{for:"itemsPerPage",class:"me-2"},"Items per page:",-1)),ve(t("select",{id:"itemsPerPage","onUpdate:modelValue":e[0]||(e[0]=l=>B.value=l),onChange:R,class:"form-select form-select-sm"},[(r(!0),d(U,null,E(G.value,l=>(r(),d("option",{key:l,value:l},u(l),9,ye))),128))],544),[[me,B.value]])]),t("div",ge,[a(se,null,{default:s(()=>[a(O,{placeholder:"Search...",modelValue:j.value,"onUpdate:modelValue":e[1]||(e[1]=l=>j.value=l)},null,8,["modelValue"]),a(oe,null,{default:s(()=>[a(k,{variant:"primary",onClick:W},{default:s(()=>e[21]||(e[21]=[b("Search")])),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1}),t("div",ke,[t("table",Pe,[t("thead",null,[t("tr",null,[t("th",{onClick:e[2]||(e[2]=l=>x("description"))},e[22]||(e[22]=[b("Description "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[3]||(e[3]=l=>x("start_date"))},e[23]||(e[23]=[b("Start Date "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[4]||(e[4]=l=>x("end_date"))},e[24]||(e[24]=[b("End Date "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[5]||(e[5]=l=>x("start_time"))},e[25]||(e[25]=[b("Start Time "),t("i",{class:"fas fa-sort"},null,-1)])),t("th",{onClick:e[6]||(e[6]=l=>x("end_time"))},e[26]||(e[26]=[b("End Time "),t("i",{class:"fas fa-sort"},null,-1)])),e[27]||(e[27]=t("th",null,"Actions",-1))])]),t("tbody",null,[Array.isArray(V.value)&&V.value.length>0?(r(!0),d(U,{key:0},E(te.value,(l,h)=>(r(),d("tr",{key:h},[t("td",null,u(l.description),1),t("td",null,u(l.start_date),1),t("td",null,u(l.end_date),1),t("td",null,u(l.start_time),1),t("td",null,u(l.end_time),1),t("td",null,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm me-3",onClick:ne=>K(l.id)},e[28]||(e[28]=[t("i",{class:"fas fa-edit"},null,-1)]),8,Ae),t("button",{type:"button",class:"btn btn-outline-warning btn-sm",onClick:ne=>X(l.id)},e[29]||(e[29]=[t("i",{class:"fas fa-cancel"},null,-1)]),8,Ve)])]))),128)):(r(),d("tr",we,e[30]||(e[30]=[t("td",{colspan:"6",class:"text-center"},"No records found.",-1)])))])])])]),_:1}),a(v,{sm:"12",lg:"12",class:"mt-2 d-flex justify-content-end"},{default:s(()=>[t("nav",xe,[t("ul",Ce,[t("li",{class:M(["page-item",{disabled:p.value===1}])},[t("button",{class:"page-link",onClick:e[7]||(e[7]=l=>I(p.value-1)),disabled:p.value===1},"Previous",8,Te)],2),(r(!0),d(U,null,E(w.value,l=>(r(),d("li",{key:l,class:M(["page-item",{active:p.value===l}])},[t("button",{class:"page-link",onClick:h=>I(l)},u(l),9,$e)],2))),128)),t("li",{class:M(["page-item",{disabled:p.value===w.value}])},[t("button",{class:"page-link",onClick:e[8]||(e[8]=l=>I(p.value+1)),disabled:p.value===w.value},"Next",8,De)],2)])])]),_:1})]),_:1}),a(Y,{ref_key:"newAvailability",ref:F,title:"New Availability",class:"modal-fullscreen my-modal","no-close-on-backdrop":"","no-close-on-esc":"",size:"xl","hide-footer":""},{default:s(()=>[e[36]||(e[36]=t("h4",null,"Availability Settings",-1)),a(C,null,{default:s(()=>[a(v,{md:"12"},{default:s(()=>[t("div",Se,[e[31]||(e[31]=t("label",{for:"startDatePicker",class:"form-label"},"Start Date",-1)),a(y(g),{modelValue:i.value.start_date,"onUpdate:modelValue":e[9]||(e[9]=l=>i.value.start_date=l),class:"form-control",config:T,id:"startDatePicker"},null,8,["modelValue"])]),n.value.start_date?(r(),d("div",Ue,u(n.value.start_date),1)):f("",!0)]),_:1}),a(v,{md:"12"},{default:s(()=>[t("div",Fe,[e[32]||(e[32]=t("label",{for:"endDatePicker",class:"form-label"},"Last Date",-1)),a(y(g),{modelValue:i.value.end_date,"onUpdate:modelValue":e[10]||(e[10]=l=>i.value.end_date=l),class:"form-control",config:T,id:"endDatePicker"},null,8,["modelValue"])]),n.value.end_date?(r(),d("div",Ne,u(n.value.end_date),1)):f("",!0)]),_:1})]),_:1}),a(C,null,{default:s(()=>[a(v,{md:"6"},{default:s(()=>[t("div",Be,[e[33]||(e[33]=t("label",{for:"startTimePicker",class:"form-label"},"Start Time",-1)),a(y(g),{modelValue:i.value.start_time,"onUpdate:modelValue":e[11]||(e[11]=l=>i.value.start_time=l),class:"form-control",config:$,id:"startTimePicker"},null,8,["modelValue"])]),n.value.start_time?(r(),d("div",je,u(n.value.start_time),1)):f("",!0)]),_:1}),a(v,{md:"5"},{default:s(()=>[t("div",Ie,[e[34]||(e[34]=t("label",{for:"endTimePicker",class:"form-label"},"End Time",-1)),a(y(g),{modelValue:i.value.end_time,"onUpdate:modelValue":e[12]||(e[12]=l=>i.value.end_time=l),class:"form-control",config:$,id:"endTimePicker"},null,8,["modelValue"])]),n.value.end_time?(r(),d("div",Oe,u(n.value.end_time),1)):f("",!0)]),_:1}),a(v,{md:"12",class:"mb-3"},{default:s(()=>[a(L,{label:"Description","label-for":"descriptionField"},{default:s(()=>[a(O,{id:"descriptionField",type:"text",modelValue:i.value.description,"onUpdate:modelValue":e[13]||(e[13]=l=>i.value.description=l)},null,8,["modelValue"]),n.value.description?(r(),d("div",Ee,u(n.value.description),1)):f("",!0)]),_:1})]),_:1})]),_:1}),t("div",Me,[a(k,{onClick:le,variant:"primary"},{default:s(()=>e[35]||(e[35]=[b("Save")])),_:1})])]),_:1},512),a(Y,{ref_key:"updateAvailability",ref:N,title:"update Availability",class:"modal-fullscreen my-modal","no-close-on-backdrop":"","no-close-on-esc":"",size:"xl","hide-footer":""},{default:s(()=>[e[42]||(e[42]=t("h4",null,"Availability Settings",-1)),a(C,null,{default:s(()=>[a(v,{md:"12"},{default:s(()=>[t("div",ze,[e[37]||(e[37]=t("label",{for:"startDatePicker",class:"form-label"},"Start Date",-1)),a(y(g),{modelValue:i.value.start_date,"onUpdate:modelValue":e[14]||(e[14]=l=>i.value.start_date=l),class:"form-control",config:T,id:"startDatePicker"},null,8,["modelValue"])]),n.value.start_date?(r(),d("div",Le,u(n.value.start_date),1)):f("",!0)]),_:1}),a(v,{md:"12"},{default:s(()=>[t("div",Ye,[e[38]||(e[38]=t("label",{for:"endDatePicker",class:"form-label"},"Last Date",-1)),a(y(g),{modelValue:i.value.end_date,"onUpdate:modelValue":e[15]||(e[15]=l=>i.value.end_date=l),class:"form-control",config:T,id:"endDatePicker"},null,8,["modelValue"])]),n.value.end_date?(r(),d("div",he,u(n.value.end_date),1)):f("",!0)]),_:1})]),_:1}),a(C,null,{default:s(()=>[a(v,{md:"6"},{default:s(()=>[t("div",qe,[e[39]||(e[39]=t("label",{for:"startTimePicker",class:"form-label"},"Start Time",-1)),a(y(g),{modelValue:i.value.start_time,"onUpdate:modelValue":e[16]||(e[16]=l=>i.value.start_time=l),class:"form-control",config:$,id:"startTimePicker"},null,8,["modelValue"])]),n.value.start_time?(r(),d("div",He,u(n.value.start_time),1)):f("",!0)]),_:1}),a(v,{md:"5"},{default:s(()=>[t("div",Ke,[e[40]||(e[40]=t("label",{for:"endTimePicker",class:"form-label"},"End Time",-1)),a(y(g),{modelValue:i.value.end_time,"onUpdate:modelValue":e[17]||(e[17]=l=>i.value.end_time=l),class:"form-control",config:$,id:"endTimePicker"},null,8,["modelValue"])]),n.value.end_time?(r(),d("div",Qe,u(n.value.end_time),1)):f("",!0)]),_:1}),a(v,{md:"12",class:"mb-3"},{default:s(()=>[a(L,{label:"Description","label-for":"descriptionField"},{default:s(()=>[a(O,{id:"descriptionField",type:"text",modelValue:i.value.description,"onUpdate:modelValue":e[18]||(e[18]=l=>i.value.description=l)},null,8,["modelValue"]),n.value.description?(r(),d("div",Ge,u(n.value.description),1)):f("",!0)]),_:1})]),_:1})]),_:1}),t("div",Je,[a(k,{onClick:ae,variant:"primary"},{default:s(()=>e[41]||(e[41]=[b("Update")])),_:1})])]),_:1},512)],64)}}};var et=re(Re,[["__scopeId","data-v-677d9f53"]]);export{et as default};
