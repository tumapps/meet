import{A as M,i as C,j as u,Y as T,k as U,u as V,r as g,o as n,c as l,b as s,d as b,w,X as E,f as j,m as h,v as A,t as k,n as m,J as D,G as N,e as B,Z as F,p as R}from"./index.e0205fad.js";import"./pdfjs.7adb8c57.js";const $={class:"iq-auth-page"},q={class:"row m-0 align-items-center justify-content-center vh-100 w-100"},J={class:"col-md-4 col-lg-3"},Y=["src"],z={class:"form-group"},G={key:0,class:"error","aria-live":"polite"},L={class:"form-group position-relative"},X=["type"],Z={key:0,class:"error","aria-live":"polite"},H={class:"d-flex justify-content-between align-items-center mb-3"},K={class:"text-center pb-3"},O=["disabled"],Q={key:1,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},se={__name:"SignIn",setup(W){const x=M(),_=C(),r=u(!1),p=u(""),y=u(""),t=T({username:"",password:"",general:""}),d=U(),P=V(),{proxy:f}=R();function S(){_.navigateToFirstMenu(P)}const I=async()=>{var a;t.username="",t.password="",t.general="";const v={username:p.value,password:y.value};try{r.value=!0;const e=await x.post("/v1/iam/auth/login",v);if(e.data.dataPayload&&!e.data.dataPayload.error&&e.data.dataPayload.data.menus){d.setToken(e.data.dataPayload.data.access_token,e.data.dataPayload.data.username);const o=e.data.dataPayload.data.access_token;d.setUserId(o),d.setRole(e.data.dataPayload.data.roles[0]),console.log("hello",d.getUserId()),_.setMenus(e.data.dataPayload.data.menus),localStorage.setItem("loggedIn",!0),console.log("hello"),e.data.alertifyPayload&&(f.$showToast({title:e.data.alertifyPayload.message,text:e.data.alertifyPayload.message,icon:e.data.alertifyPayload.theme}),S())}}catch(e){if(console.log("catch block triggered",(a=e.response)==null?void 0:a.data),console.log("my error",e),e.response&&e.response.status===422&&e.response.data.errorPayload){console.log("hello errors");const o=e.response.data.errorPayload.errors;t.username=o.username||"",t.password=o.password||""}else f.$showToast({title:"error",text:"An unexpected error occurred!",icon:"error"})}finally{r.value=!1}},i=u(!1);return(v,a)=>{const e=g("router-link"),o=g("b-card");return n(),l("section",$,[s("div",q,[s("div",J,[b(o,{class:"h-100 py-5 d-flex flex-column justify-content-between",style:{background:"white !important"}},{default:w(()=>[s("img",{src:E||F,class:"d-block mx-auto logo-img",alt:"logo"},null,8,Y),a[7]||(a[7]=s("h5",{class:"text-center mt-3 mb-4 fw-bold text-primary"},"Sign In | TUMMEET",-1)),s("form",{onSubmit:j(I,["prevent"])},[s("div",z,[a[3]||(a[3]=s("label",{class:"form-label",for:"username-id"},"Username",-1)),h(s("input",{type:"text",class:"form-control mb-0",id:"username","onUpdate:modelValue":a[0]||(a[0]=c=>p.value=c),placeholder:"Enter username","aria-label":"Username"},null,512),[[A,p.value]]),t.username?(n(),l("div",G,k(t.username),1)):m("",!0)]),s("div",L,[a[4]||(a[4]=s("label",{class:"form-label",for:"password"},"Password",-1)),h(s("input",{type:i.value?"text":"password",class:"form-control mb-0 pe-5",id:"password","onUpdate:modelValue":a[1]||(a[1]=c=>y.value=c),placeholder:"Enter password",autocomplete:"current-password","aria-label":"Password"},null,8,X),[[D,y.value]]),s("i",{class:N(["fas",i.value?"fa-eye":"fa-eye-slash"]),onClick:a[2]||(a[2]=c=>i.value=!i.value),style:{position:"absolute",top:"50%",right:"15px",transform:"translateY(50%)",cursor:"pointer",color:"#6c757d"}},null,2),t.password?(n(),l("div",Z,k(t.password),1)):m("",!0)]),s("div",H,[a[6]||(a[6]=s("div",{class:"form-check d-inline-block pt-1 mb-0"},[s("input",{type:"checkbox",class:"form-check-input",id:"customCheck11"}),s("label",{class:"form-check-label",for:"customCheck11"},"Remember Me")],-1)),b(e,{to:{name:"request-password-reset"}},{default:w(()=>a[5]||(a[5]=[B("Forgot password")])),_:1})]),s("div",K,[r.value?m("",!0):(n(),l("button",{key:0,type:"submit",class:"btn btn-primary",disabled:r.value,"aria-label":"Sign in"},"Sign in",8,O)),r.value?(n(),l("span",Q)):m("",!0)])],32)]),_:1})])])])}}};export{se as default};
