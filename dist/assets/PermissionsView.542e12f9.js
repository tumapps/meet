import{A as U,j as u,z as q,y as E,q as G,r as d,o as i,g as K,w as o,d as n,b as t,m as L,D as Q,c,C as P,F as k,e as V,G as w,t as b,p as H}from"./index.8cdfa475.js";import"./pdfjs.7adb8c57.js";const J={class:"d-flex justify-content-between"},R={class:"d-flex align-items-center"},W=["value"],X={class:"d-flex align-items-center"},Y={class:"table-responsive"},Z={class:"table table-hover"},ee={key:1},te={"aria-label":"Page navigation"},se={class:"pagination justify-content-end"},ae=["disabled"],oe=["onClick"],ne=["disabled"],ie={__name:"PermissionsView",setup(le){const x=U(),{proxy:C}=H(),j=u("asc"),_=u(""),m=u(""),l=u(1),v=u(1),y=u(20),A=u(20),D=u([20,50]),g=u([]),N=u({}),f=a=>{a>0&&a<=v.value&&(l.value=a,p(a))},p=async(a=l.value)=>{try{const e=await x.get(`/v1/auth/permissions?page=${a}&per-page=${y.value}&_search=${m.value}`);g.value=Object.values(e.data.dataPayload.data),l.value=e.data.dataPayload.currentPage,v.value=e.data.dataPayload.totalPages,A.value=e.data.dataPayload.perPage}catch(e){console.error(e)}};q(m,()=>{p(1)});const S=E(()=>[...g.value].sort((a,e)=>{let r=j.value==="asc"?1:-1;return a[_.value]<e[_.value]?-1*r:a[_.value]>e[_.value]?1*r:0})),T=async()=>{await p(1)},B=async()=>{var a;try{const e=await x.get("v1/auth/sync-permissions");C.$showToast({title:e.data.toastPayload.toastMessage||"success",icon:"success"})}catch(e){console.error(e),N.value=e.response.data.errorPayload.errors;const r=((a=e.response.data.errorPayload.errors)==null?void 0:a.message)||e.response.data.errorPayload.message||"An unknown error occurred";C.$showToast({title:"An error occurred",text:r,icon:"error"})}};return G(()=>{p()}),(a,e)=>{const r=d("b-col"),h=d("b-row"),M=d("b-form-input"),I=d("b-button"),O=d("b-input-group-append"),z=d("b-input-group"),F=d("b-card");return i(),K(r,{lg:"12"},{default:o(()=>[n(F,null,{default:o(()=>[n(h,{class:"mb-5"},{default:o(()=>[n(r,{lg:"6"},{default:o(()=>e[6]||(e[6]=[t("div",null,[t("h2",null,"Permissions")],-1)])),_:1}),n(r,{lg:"6"},{default:o(()=>[t("div",{class:"d-flex justify-content-end"},[t("button",{class:"btn btn-primary",onClick:B},"Sync Permissions")])]),_:1})]),_:1}),n(h,{class:"mb-3"},{default:o(()=>[n(r,{lg:"12"},{default:o(()=>[t("div",J,[t("div",R,[L(t("select",{id:"itemsPerPage","onUpdate:modelValue":e[0]||(e[0]=s=>y.value=s),onChange:T,class:"form-select form-select-sm"},[(i(!0),c(k,null,P(D.value,s=>(i(),c("option",{key:s,value:s},b(s),9,W))),128))],544),[[Q,y.value]])]),t("div",X,[n(z,null,{default:o(()=>[n(M,{placeholder:"Search...",modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=s=>m.value=s)},null,8,["modelValue"]),n(O,null,{default:o(()=>[n(I,{variant:"primary",onClick:e[2]||(e[2]=s=>p(1))},{default:o(()=>e[7]||(e[7]=[V("Search")])),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1}),t("div",Y,[t("table",Z,[t("thead",null,[t("tr",null,[t("th",{onClick:e[3]||(e[3]=s=>a.sortTable("start_date"))},e[8]||(e[8]=[V("Name "),t("i",{class:"fas fa-sort"},null,-1)])),e[9]||(e[9]=t("th",null,"Description",-1))])]),t("tbody",null,[Array.isArray(g.value)&&g.value.length>0?(i(!0),c(k,{key:0},P(S.value,(s,$)=>(i(),c("tr",{key:$},[t("td",null,b(s.name),1),t("td",null,b(s.data),1)]))),128)):(i(),c("tr",ee,e[10]||(e[10]=[t("td",{colspan:"6",class:"text-center"},"No records found.",-1)])))])])]),n(r,{sm:"12",lg:"12",class:"mt-5 d-flex justify-content-end mb-n5"},{default:o(()=>[t("nav",te,[t("ul",se,[t("li",{class:w(["page-item",{disabled:l.value===1}])},[t("button",{class:"page-link",onClick:e[4]||(e[4]=s=>f(l.value-1)),disabled:l.value===1},"Previous",8,ae)],2),(i(!0),c(k,null,P(v.value,s=>(i(),c("li",{key:s,class:w(["page-item",{active:l.value===s}])},[t("button",{class:"page-link",onClick:$=>f(s)},b(s),9,oe)],2))),128)),t("li",{class:w(["page-item",{disabled:l.value===v.value}])},[t("button",{class:"page-link",onClick:e[5]||(e[5]=s=>f(l.value+1)),disabled:l.value===v.value},"Next",8,ne)],2)])])]),_:1})]),_:1})]),_:1})}}};export{ie as default};
