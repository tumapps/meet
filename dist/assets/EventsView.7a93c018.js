import{_ as Y,j as u,A as Z,y as ee,z as te,q as ne,r as p,o,c as r,d as i,w as d,b as n,e as C,m as le,D as se,F as D,C as V,G as h,t as b,n as x,p as ae}from"./index.16224396.js";import{_ as oe}from"./AddEvent.d8439bc4.js";import{_ as re}from"./viewEvent.90c5e5cd.js";import"./pdfjs.7adb8c57.js";import"./component.10f86d39.js";import"./index.f7b24e3d.js";const ie={class:"d-flex justify-content-end"},ue={class:"d-flex justify-content-between"},de={class:"d-flex align-items-center"},ce=["value"],ve={class:"d-flex align-items-center"},fe={class:"table-responsive"},be={class:"table table-hover"},pe=["onClick","disabled"],me=["onClick"],_e=["onClick","disabled"],ye={key:3,class:"btn btn-outline-warning btn-sm me-3",disabled:""},Ce=["onClick","disabled"],ge={key:5,class:"btn btn-outline-danger btn-sm me-3",disabled:""},Ee=["onClick"],ke={key:1},we={"aria-label":"Page navigation"},Pe={class:"pagination justify-content-end"},De=["disabled"],he=["onClick"],xe=["disabled"],$e={__name:"EventsView",setup(Be){const m=u(""),{proxy:c}=ae(),$=Z(),g=u([]),_=u(""),E=u("asc"),f=u(1),y=u(1),R=u(20),B=u(20),F=u([20,50]),k=u(""),O=u(""),T=u(null),A=u(null),q=s=>{A.value&&A.value.showModal(s)},S=s=>{s>0&&s<=y.value&&(f.value=s,v(s))},z=async()=>{f.value=1,await v(1)},L=s=>{_.value===s?E.value=E.value==="asc"?"desc":"asc":(_.value=s,E.value="asc")},G=ee(()=>[...g.value].sort((s,e)=>{let l=E.value==="asc"?1:-1;return s[_.value]<e[_.value]?-1*l:s[_.value]>e[_.value]?1*l:0})),N=u(null),M=s=>{T.value&&(N.value=s,console.log("event_id sending",N.value),T.value.show())},v=async s=>{var e;try{const l=await $.get(`v1/scheduler/events?page=${s}&perPage=${B.value}&_q=${k.value}`);g.value=l.data.dataPayload.data,f.value=l.data.dataPayload.currentPage,y.value=l.data.dataPayload.totalPages,R.value=l.data.dataPayload.perPage}catch(l){const a=((e=l.response.data.errorPayload.errors)==null?void 0:e.message)||"An error occurred";c.$showToast({title:a,icon:"error"})}};te(k,()=>{v(1)});const j=(s,e)=>{c.$showAlert({title:"Are you sure?",text:" Do you want to "+e+" this Event ?",icon:"warning",showCancelButton:!0,confirmButtonText:e,cancelButtonText:"Cancel",confirmButtonColor:"#076232",cancelButtonColor:"#d33"}).then(l=>{l.isConfirmed&&K(s)})},K=async s=>{var e;try{const l=await $.delete(`v1/scheduler/events/${s}`);v(1),l.data.alertifyPayload?(m.value=l.data.alertifyPayload,c.$showToast({title:m.value.message||"Deleted successfully",icon:"success"})):c.$showToast({title:"success",icon:"success"})}catch(l){const a=(e=l.response.data.errorPayload.errors)==null?void 0:e.message;c.$showToast({title:a,text:a,icon:"error"})}},U=async(s,e)=>{var l;try{const a=await $.put(`v1/scheduler/cancel/${s}`,{cancellation_reason:e});a.data.alertifyPayload?(m.value=a.data.alertifyPayload,c.$showAlert({title:m.value.theme,icon:m.value.theme,text:m.value.message,showCancelButton:!1,showConfirmButton:!1,timer:4e3,timerProgressBar:!0})):c.$showToast({title:"operation successful",icon:"success"}),v(1)}catch(a){if(a.response&&a.response.data.errorPayload)O.value=a.response.data.errorPayload.errors;else{const w=(l=a.response.data.errorPayload.errors)==null?void 0:l.message;c.$showToast({title:"An error occurred",text:w,icon:"error"})}}},Q=s=>{c.$showAlert({title:"Cancel Event",text:"Do you want to Cancel this Event ?",icon:"warning",showCancelButton:!0,confirmButtonText:"Proceed",cancelButtonText:"Cancel",confirmButtonColor:"#076232",cancelButtonColor:"#d33"}).then(e=>{if(e.isConfirmed){const l=()=>{c.$showAlert({title:"Event Cancellation",text:"Please provide a reason for cancelling this Event.",input:"text",inputPlaceholder:"reason",inputAttributes:{maxlength:100},showCancelButton:!0,confirmButtonText:"Submit",cancelButtonText:"Cancel",confirmButtonColor:"#076232",cancelButtonColor:"#d33"}).then(a=>{a.isConfirmed&&(!a.value||a.value.trim()===""?c.$showAlert({title:"Invalid Input",text:"Reason cannot be empty. Please provide a valid reason.",icon:"error",confirmButtonText:"OK",confirmButtonColor:"#d33",showCancelButton:!1}).then(()=>{l()}):(U(s,a.value.trim()),v(1)))})};l()}})};return ne(async()=>{v(1)}),(s,e)=>{const l=p("b-col"),a=p("b-button"),w=p("b-row"),H=p("b-form-input"),J=p("b-input-group-append"),W=p("b-input-group"),X=p("b-card");return o(),r(D,null,[i(l,{lg:"12"},{default:d(()=>[i(X,null,{default:d(()=>[i(w,{class:"mb-5"},{default:d(()=>[i(l,{lg:"6"},{default:d(()=>e[9]||(e[9]=[n("div",null,[n("h2",null,"Events")],-1)])),_:1}),i(l,{lg:"6"},{default:d(()=>[n("div",ie,[i(a,{variant:"primary",onClick:q},{default:d(()=>e[10]||(e[10]=[C(" Add Event ")])),_:1})])]),_:1})]),_:1}),i(w,{class:"mb-3"},{default:d(()=>[i(l,{lg:"12",md:"12",sm:"12"},{default:d(()=>[n("div",ue,[n("div",de,[le(n("select",{id:"itemsPerPage","onUpdate:modelValue":e[0]||(e[0]=t=>B.value=t),onChange:z,class:"form-select form-select-sm",style:{width:"auto"}},[(o(!0),r(D,null,V(F.value,t=>(o(),r("option",{key:t,value:t},b(t),9,ce))),128))],544),[[se,B.value]])]),n("div",ve,[i(W,null,{default:d(()=>[i(H,{placeholder:"Search...","aria-label":"Search",modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=t=>k.value=t)},null,8,["modelValue"]),i(J,null,{default:d(()=>[i(a,{variant:"primary",onChange:e[2]||(e[2]=t=>v(1)),onClick:e[3]||(e[3]=t=>v(1))},{default:d(()=>e[11]||(e[11]=[C(" Search ")])),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1}),n("div",fe,[n("table",be,[n("thead",null,[n("tr",null,[n("th",{onClick:e[4]||(e[4]=t=>L("title"))},e[12]||(e[12]=[C(" Title "),n("i",{class:"fas fa-sort"},null,-1)])),e[15]||(e[15]=n("th",null,"Description",-1)),n("th",{onClick:e[5]||(e[5]=t=>L("appointment_date"))},e[13]||(e[13]=[C(" Date "),n("i",{class:"fas fa-sort"},null,-1)])),n("th",{onClick:e[6]||(e[6]=t=>L("start_time"))},e[14]||(e[14]=[C(" Time "),n("i",{class:"fas fa-sort"},null,-1)])),e[16]||(e[16]=n("th",null,"Status",-1)),e[17]||(e[17]=n("th",null,"Actions",-1))])]),n("tbody",null,[Array.isArray(g.value)&&g.value.length>0?(o(!0),r(D,{key:0},V(G.value,(t,I)=>(o(),r("tr",{key:I},[n("td",null,b(t.title),1),n("td",null,b(t.description),1),n("td",null,b(t.start_date)+" - "+b(t.end_date),1),n("td",null,b(t.start_time)+" - "+b(t.end_time),1),n("td",null,[n("span",{class:h("badge bg-"+t.recordStatus.theme)},b(t.recordStatus.label),3)]),n("td",null,[t.recordStatus.label!=="DELETED"&&t.recordStatus.label!=="CANCELLED"?(o(),r("button",{key:0,class:"btn btn-outline-primary btn-sm me-3",onClick:P=>M(t.id),disabled:t.checked_in},e[18]||(e[18]=[n("i",{class:"fas fa-edit",title:"Edit"},null,-1)]),8,pe)):t.recordStatus.label==="DELETED"||t.recordStatus.label==="CANCELLED"?(o(),r("button",{key:1,class:"btn btn-outline-primary btn-sm me-3",onClick:P=>M(t.id)},e[19]||(e[19]=[n("i",{class:"fas fa-eye",title:"View"},null,-1)]),8,me)):x("",!0),t.recordStatus.label!=="DELETED"&&t.recordStatus.label!=="CANCELLED"?(o(),r("button",{key:2,class:"btn btn-outline-warning btn-sm me-3",onClick:P=>Q(t.id,"Cancel"),disabled:t.checked_in},e[20]||(e[20]=[n("i",{class:"fas fa-cancel",title:"Cancel"},null,-1)]),8,_e)):t.recordStatus.label==="DELETED"||t.recordStatus.label==="CANCELLED"?(o(),r("button",ye,e[21]||(e[21]=[n("i",{class:"fas fa-cancel",title:"Cancel (Disabled)"},null,-1)]))):x("",!0),t.recordStatus.label!=="DELETED"&&t.recordStatus.label!=="CANCELLED"?(o(),r("button",{key:4,class:"btn btn-outline-danger btn-sm me-3",onClick:P=>j(t.id,"Delete"),disabled:t.checked_in},e[22]||(e[22]=[n("i",{class:"fas fa-trash",title:"Delete"},null,-1)]),8,Ce)):t.recordStatus.label==="CANCELLED"?(o(),r("button",ge,e[23]||(e[23]=[n("i",{class:"fas fa-trash",title:"Delete (Disabled)"},null,-1)]))):x("",!0),t.recordStatus.label==="DELETED"?(o(),r("button",{key:6,class:"btn btn-outline-danger btn-sm",onClick:P=>j(t.id,"Restore")},e[24]||(e[24]=[n("i",{class:"fas fa-undo",title:"Restore"},null,-1)]),8,Ee)):x("",!0)])]))),128)):(o(),r("tr",ke,e[25]||(e[25]=[n("td",{colspan:"6",class:"text-center"},"No records found.",-1)])))])])]),i(l,{sm:"12",lg:"12",md:"12",class:"d-flex justify-content-end mt-5 mb-n5"},{default:d(()=>[n("nav",we,[n("ul",Pe,[n("li",{class:h(["page-item",{disabled:f.value===1}])},[n("button",{class:"page-link",onClick:e[7]||(e[7]=t=>S(f.value-1)),disabled:f.value===1},"Previous",8,De)],2),(o(!0),r(D,null,V(y.value,t=>(o(),r("li",{key:t,class:h(["page-item",{active:f.value===t}])},[n("button",{class:"page-link",onClick:I=>S(t)},b(t),9,he)],2))),128)),n("li",{class:h(["page-item",{disabled:f.value===y.value}])},[n("button",{class:"page-link",onClick:e[8]||(e[8]=t=>S(f.value+1)),disabled:f.value===y.value},"Next",8,xe)],2)])])]),_:1})]),_:1})]),_:1}),i(oe,{ref_key:"eventModalRef",ref:A,onNewEvent:v},null,512),i(re,{ref_key:"editevent",ref:T,onGetEvents:v,event_id:N.value},null,8,["event_id"])],64)}}};var Me=Y($e,[["__scopeId","data-v-0ab35e22"]]);export{Me as default};
